
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>KubernetesCIS Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="Kubernetes.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <a target="_blank" href="https://twitter.com/HackerOtter">
            
                    
                    Follow On Twitter
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" >
            
                <span>
            
                    
                    Formation
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" >
            
                <span>
            
                    
                    Malware Development
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1.1" data-path="../../Formation/RTO - Malware Development/0 - Introduction.html">
            
                <a href="../../Formation/RTO - Malware Development/0 - Introduction.html">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.2" data-path="../../Formation/RTO - Malware Development/1 - PE.html">
            
                <a href="../../Formation/RTO - Malware Development/1 - PE.html">
            
                    
                    PE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.3" data-path="../../Formation/RTO - Malware Development/2 - Payload Storage.html">
            
                <a href="../../Formation/RTO - Malware Development/2 - Payload Storage.html">
            
                    
                    Payload Storage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.4" data-path="../../Formation/RTO - Malware Development/3 - Payload Encryption.html">
            
                <a href="../../Formation/RTO - Malware Development/3 - Payload Encryption.html">
            
                    
                    Payload Encryption
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.5" data-path="../../Formation/RTO - Malware Development/4 - Function Call Obfuscation.html">
            
                <a href="../../Formation/RTO - Malware Development/4 - Function Call Obfuscation.html">
            
                    
                    Function Call Obfuscation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.6" data-path="../../Formation/RTO - Malware Development/5 - Backdooring PE.html">
            
                <a href="../../Formation/RTO - Malware Development/5 - Backdooring PE.html">
            
                    
                    Backdooring PE
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" >
            
                <span>
            
                    
                    Malware
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" >
            
                <span>
            
                    
                    Docs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1.1" data-path="../../Malware/Docs/Code snippet.html">
            
                <a href="../../Malware/Docs/Code snippet.html">
            
                    
                    Code Snippet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.2" data-path="../../Malware/Docs/Dumpbin.html">
            
                <a href="../../Malware/Docs/Dumpbin.html">
            
                    
                    Dumpbin
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.3" data-path="../../Malware/Docs/NTStructure.html">
            
                <a href="../../Malware/Docs/NTStructure.html">
            
                    
                    NTStructure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.4" data-path="../../Malware/Docs/Passing arguments.html">
            
                <a href="../../Malware/Docs/Passing arguments.html">
            
                    
                    Passing Arguments
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../../Malware/CoffLoader.html">
            
                <a href="../../Malware/CoffLoader.html">
            
                    
                    COFF Loader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../../Malware/Elastic EDR.html">
            
                <a href="../../Malware/Elastic EDR.html">
            
                    
                    Elastic EDR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="../../Malware/ETW.html">
            
                <a href="../../Malware/ETW.html">
            
                    
                    ETW
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.5" data-path="../../Malware/Function hooking.html">
            
                <a href="../../Malware/Function hooking.html">
            
                    
                    Function Hooking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.6" data-path="../../Malware/Kernel callback.html">
            
                <a href="../../Malware/Kernel callback.html">
            
                    
                    Kernel Callback
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7" data-path="../../Malware/Module stomping.html">
            
                <a href="../../Malware/Module stomping.html">
            
                    
                    Module Stomping
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.8" data-path="../../Malware/Reflective DLL injection.html">
            
                <a href="../../Malware/Reflective DLL injection.html">
            
                    
                    Reflective DLL Injection
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" >
            
                <span>
            
                    
                    Pentest
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" >
            
                <span>
            
                    
                    Cloud
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1.1" data-path="../Cloud/Azure.html">
            
                <a href="../Cloud/Azure.html">
            
                    
                    Azure
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.2" >
            
                <span>
            
                    
                    Configuration Review
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.2.1" data-path="Database.html">
            
                <a href="Database.html">
            
                    
                    Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2.2" data-path="Kubernetes.html">
            
                <a href="Kubernetes.html">
            
                    
                    Kubernetes
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.1.2.3" data-path="KubernetesCIS.html">
            
                <a href="KubernetesCIS.html">
            
                    
                    KubernetesCIS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.3" >
            
                <span>
            
                    
                    Services
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.3.1" data-path="../Services/AD.html">
            
                <a href="../Services/AD.html">
            
                    
                    AD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.2" data-path="../Services/DNS.html">
            
                <a href="../Services/DNS.html">
            
                    
                    DNS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.3" data-path="../Services/IPMI.html">
            
                <a href="../Services/IPMI.html">
            
                    
                    IPMI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.4" data-path="../Services/Kerberos.html">
            
                <a href="../Services/Kerberos.html">
            
                    
                    Kerberos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.5" data-path="../Services/LDAP.html">
            
                <a href="../Services/LDAP.html">
            
                    
                    LDAP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.6" data-path="../Services/Memcached.html">
            
                <a href="../Services/Memcached.html">
            
                    
                    Memcached
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.7" data-path="../Services/NFS.html">
            
                <a href="../Services/NFS.html">
            
                    
                    NFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.8" data-path="../Services/Oracle database.html">
            
                <a href="../Services/Oracle database.html">
            
                    
                    Oracle Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.9" data-path="../Services/MSSQL.html">
            
                <a href="../Services/MSSQL.html">
            
                    
                    MSSQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.10" data-path="../Services/RPC.html">
            
                <a href="../Services/RPC.html">
            
                    
                    RPC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.11" data-path="../Services/SMB.html">
            
                <a href="../Services/SMB.html">
            
                    
                    SMB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.12" data-path="../Services/SNMP.html">
            
                <a href="../Services/SNMP.html">
            
                    
                    SNMP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.13" data-path="../Services/Tomcat.html">
            
                <a href="../Services/Tomcat.html">
            
                    
                    Tomcat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3.14" data-path="../Services/WebDAV.html">
            
                <a href="../Services/WebDAV.html">
            
                    
                    WebDAV
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.4" >
            
                <span>
            
                    
                    Techniques
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.4.1" data-path="../Techniques/Abuse tokens.html">
            
                <a href="../Techniques/Abuse tokens.html">
            
                    
                    Abuse Tokens
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.2" data-path="../Techniques/Buffer overflow.html">
            
                <a href="../Techniques/Buffer overflow.html">
            
                    
                    Buffer Overflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.3" data-path="../Techniques/Command injection.html">
            
                <a href="../Techniques/Command injection.html">
            
                    
                    Command Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.4" data-path="../Techniques/Data exfiltration.html">
            
                <a href="../Techniques/Data exfiltration.html">
            
                    
                    Data Exfiltration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.5" data-path="../Techniques/Exploit handles.html">
            
                <a href="../Techniques/Exploit handles.html">
            
                    
                    Exploit handles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.6" data-path="../Techniques/Filtering.html">
            
                <a href="../Techniques/Filtering.html">
            
                    
                    Filtering
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.7" data-path="../Techniques/Kioske escape.html">
            
                <a href="../Techniques/Kioske escape.html">
            
                    
                    Kioske Escape
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.8" data-path="../Techniques/LFI.html">
            
                <a href="../Techniques/LFI.html">
            
                    
                    LFI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.9" data-path="../Techniques/Password spraying.html">
            
                <a href="../Techniques/Password spraying.html">
            
                    
                    Password Spraying
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.10" data-path="../Techniques/Pivoting.html">
            
                <a href="../Techniques/Pivoting.html">
            
                    
                    Pivoting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.11" >
            
                <span>
            
                    
                    Privilege Escalation
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.4.11.1" data-path="../Techniques/Privileges escalation/Windows.html">
            
                <a href="../Techniques/Privileges escalation/Windows.html">
            
                    
                    Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.11.2" data-path="../Techniques/Privileges escalation/Linux.html">
            
                <a href="../Techniques/Privileges escalation/Linux.html">
            
                    
                    Linux
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.4.12" data-path="../Techniques/Reverse shell.html">
            
                <a href="../Techniques/Reverse shell.html">
            
                    
                    Reverse Shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.13" data-path="../Techniques/Shellshock.html">
            
                <a href="../Techniques/Shellshock.html">
            
                    
                    Shellshock
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.14" data-path="../Techniques/SQL injection.html">
            
                <a href="../Techniques/SQL injection.html">
            
                    
                    SQL Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4.15" data-path="../Techniques/SSTI.html">
            
                <a href="../Techniques/SSTI.html">
            
                    
                    SSTI
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.5" >
            
                <span>
            
                    
                    Technology
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.5.1" data-path="../Technology/AD.html">
            
                <a href="../Technology/AD.html">
            
                    
                    AD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.5.2" data-path="../Technology/IOS.html">
            
                <a href="../Technology/IOS.html">
            
                    
                    IOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.5.3" data-path="../Technology/NAC.html">
            
                <a href="../Technology/NAC.html">
            
                    
                    NAC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.5.4" data-path="../Technology/Port Knocking.html">
            
                <a href="../Technology/Port Knocking.html">
            
                    
                    Port Knocking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.5.5" data-path="../Technology/SAML.html">
            
                <a href="../Technology/SAML.html">
            
                    
                    SAML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.5.6" data-path="../Technology/SAP.html">
            
                <a href="../Technology/SAP.html">
            
                    
                    SAP
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.6" >
            
                <span>
            
                    
                    Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.6.1" data-path="../Tools/BloundHound.html">
            
                <a href="../Tools/BloundHound.html">
            
                    
                    BloundHound
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.2" data-path="../Tools/CME.html">
            
                <a href="../Tools/CME.html">
            
                    
                    CME
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.3" data-path="../Tools/Curl.html">
            
                <a href="../Tools/Curl.html">
            
                    
                    Curl
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.4" data-path="../Tools/Ffuf.html">
            
                <a href="../Tools/Ffuf.html">
            
                    
                    FFUF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.5" data-path="../Tools/Find.html">
            
                <a href="../Tools/Find.html">
            
                    
                    Find
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.6" data-path="../Tools/Hydra.html">
            
                <a href="../Tools/Hydra.html">
            
                    
                    Hydra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.7" data-path="../Tools/PowerView.html">
            
                <a href="../Tools/PowerView.html">
            
                    
                    PowerView
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.8" data-path="../Tools/Powershell.html">
            
                <a href="../Tools/Powershell.html">
            
                    
                    Powershell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.9" data-path="../Tools/Responder.html">
            
                <a href="../Tools/Responder.html">
            
                    
                    Responder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.10" data-path="../Tools/Rubeus.html">
            
                <a href="../Tools/Rubeus.html">
            
                    
                    Rubeus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.11" data-path="../Tools/Strace.html">
            
                <a href="../Tools/Strace.html">
            
                    
                    Strace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6.12" data-path="../Tools/Wfuzz.html">
            
                <a href="../Tools/Wfuzz.html">
            
                    
                    Wfuzz
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" >
            
                <span>
            
                    
                    Rainy Sunday
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../../Serveur/KMS/KMS.html">
            
                <a href="../../Serveur/KMS/KMS.html">
            
                    
                    KMS Activation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="../../Serveur/LicenceKey.html">
            
                <a href="../../Serveur/LicenceKey.html">
            
                    
                    Licence Key
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >KubernetesCIS</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="audit-de-configuration-kubernetes">Audit de configuration Kubernetes</h1>
<h1 id="table-of-content">Table of content</h1>
<!-- toc -->
<ul>
<li><a href="#minimal-files-to-asks">Minimal files to asks</a><ul>
<li><a href="#master-and-worker-node">Master and Worker node</a></li>
<li><a href="#api">API</a></li>
</ul>
</li>
<li><a href="#resume-des-commandes">R&#xE9;sum&#xE9; des commandes</a></li>
<li><a href="#descriptif-des-tests">Descriptif des tests</a><ul>
<li><a href="#test-0">Test 0</a></li>
<li><a href="#test-1">Test 1</a></li>
<li><a href="#test-2">Test 2</a></li>
<li><a href="#test-3">Test 3</a></li>
<li><a href="#test-4">Test 4</a></li>
<li><a href="#test-5">Test 5</a></li>
<li><a href="#test-6">Test 6</a></li>
<li><a href="#test-7">Test 7</a></li>
<li><a href="#test-8">Test 8</a></li>
<li><a href="#test-9">Test 9</a></li>
<li><a href="#test-10">Test 10</a></li>
<li><a href="#test-11">Test 11</a></li>
<li><a href="#test-12">Test 12</a></li>
<li><a href="#test-13">Test 13</a></li>
<li><a href="#test-14">Test 14</a></li>
<li><a href="#test-15">Test 15</a></li>
<li><a href="#test-16">Test 16</a></li>
<li><a href="#test-17">Test 17</a></li>
<li><a href="#test-18">Test 18</a></li>
<li><a href="#test-19">Test 19</a></li>
<li><a href="#test-20">Test 20</a></li>
<li><a href="#test-21">Test 21</a></li>
<li><a href="#test-22">Test 22</a></li>
<li><a href="#test-23">Test 23</a></li>
<li><a href="#test-24">Test 24</a></li>
<li><a href="#test-25">Test 25</a></li>
<li><a href="#test-26">Test 26</a></li>
<li><a href="#test-27">Test 27</a></li>
<li><a href="#test-28">Test 28</a></li>
<li><a href="#test-29">Test 29</a></li>
<li><a href="#test-30">Test 30</a></li>
<li><a href="#test-31">Test 31</a></li>
<li><a href="#test-32">Test 32</a></li>
<li><a href="#test-33">Test 33</a></li>
<li><a href="#test-34">Test 34</a></li>
<li><a href="#test-35">Test 35</a></li>
<li><a href="#test-36">Test 36</a></li>
<li><a href="#test-37">Test 37</a></li>
<li><a href="#test-38">Test 38</a></li>
<li><a href="#test-39">Test 39</a></li>
<li><a href="#test-40">Test 40</a></li>
<li><a href="#test-41">Test 41</a></li>
<li><a href="#test-42">Test 42</a></li>
<li><a href="#test-43">Test 43</a></li>
<li><a href="#test-44">Test 44</a></li>
<li><a href="#test-45">Test 45</a></li>
<li><a href="#test-46">Test 46</a></li>
<li><a href="#test-47">Test 47</a></li>
<li><a href="#test-48">Test 48</a></li>
<li><a href="#test-49">Test 49</a></li>
<li><a href="#test-50">Test 50</a></li>
<li><a href="#test-51">Test 51</a></li>
<li><a href="#test-52">Test 52</a></li>
<li><a href="#test-53">Test 53</a></li>
<li><a href="#test-54">Test 54</a></li>
<li><a href="#test-55">Test 55</a></li>
<li><a href="#test-56">Test 56</a></li>
<li><a href="#test-57">Test 57</a></li>
<li><a href="#test-58">Test 58</a></li>
<li><a href="#test-59">Test 59</a></li>
<li><a href="#test-60">Test 60</a></li>
<li><a href="#test-61">Test 61</a></li>
<li><a href="#test-62">Test 62</a></li>
<li><a href="#test-63">Test 63</a></li>
<li><a href="#test-64">Test 64</a></li>
<li><a href="#test-65">Test 65</a></li>
<li><a href="#test-66">Test 66</a></li>
<li><a href="#test-67">Test 67</a></li>
<li><a href="#test-68">Test 68</a></li>
<li><a href="#test-69">Test 69</a></li>
<li><a href="#test-70">Test 70</a></li>
<li><a href="#test-71">Test 71</a></li>
<li><a href="#test-72">Test 72</a></li>
<li><a href="#test-73">Test 73</a></li>
<li><a href="#test-74">Test 74</a></li>
<li><a href="#test-75">Test 75</a></li>
<li><a href="#test-76">Test 76</a></li>
<li><a href="#test-77">Test 77</a></li>
<li><a href="#test-78">Test 78</a></li>
<li><a href="#test-79">Test 79</a></li>
<li><a href="#test-80">Test 80</a></li>
<li><a href="#test-81">Test 81</a></li>
<li><a href="#test-82">Test 82</a></li>
<li><a href="#test-83">Test 83</a></li>
<li><a href="#test-84">Test 84</a></li>
<li><a href="#test-85">Test 85</a></li>
<li><a href="#test-86">Test 86</a></li>
<li><a href="#test-87">Test 87</a></li>
<li><a href="#test-88">Test 88</a></li>
<li><a href="#test-89">Test 89</a></li>
<li><a href="#test-90">Test 90</a></li>
<li><a href="#test-91">Test 91</a></li>
<li><a href="#test-92">Test 92</a></li>
<li><a href="#test-93">Test 93</a></li>
<li><a href="#test-94">Test 94</a></li>
<li><a href="#test-95">Test 95</a></li>
<li><a href="#test-96">Test 96</a></li>
<li><a href="#test-97">Test 97</a></li>
<li><a href="#test-98">Test 98</a></li>
<li><a href="#test-99">Test 99</a></li>
<li><a href="#test-100">Test 100</a></li>
<li><a href="#test-101">Test 101</a></li>
<li><a href="#test-102">Test 102</a></li>
<li><a href="#test-103">Test 103</a></li>
<li><a href="#test-104">Test 104</a></li>
<li><a href="#test-105">Test 105</a></li>
<li><a href="#test-106">Test 106</a></li>
<li><a href="#test-107">Test 107</a></li>
<li><a href="#test-108">Test 108</a></li>
<li><a href="#test-109">Test 109</a></li>
<li><a href="#test-110">Test 110</a></li>
<li><a href="#test-111">Test 111</a></li>
<li><a href="#test-112">Test 112</a></li>
<li><a href="#test-113">Test 113</a></li>
<li><a href="#test-114">Test 114</a></li>
<li><a href="#test-115">Test 115</a></li>
<li><a href="#test-116">Test 116</a></li>
<li><a href="#test-117">Test 117</a></li>
<li><a href="#test-118">Test 118</a></li>
<li><a href="#test-119">Test 119</a></li>
<li><a href="#test-120">Test 120</a></li>
<li><a href="#test-121">Test 121</a></li>
<li><a href="#test-122">Test 122</a></li>
<li><a href="#test-123">Test 123</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<h1 id="minimal-files-to-asks">Minimal files to asks</h1>
<h2 id="master-and-worker-node">Master and Worker node</h2>
<ul>
<li>Output of these commands<pre><code class="lang-bash">find /etc -ls
ps -ef
iptables -L
</code></pre>
</li>
<li>Every files in <code>/etc/kubernetes</code></li>
</ul>
<h2 id="api">API</h2>
<p>Retrieve these information in <code>YAML</code> format :</p>
<ul>
<li>Namespace</li>
<li>ClusterRole</li>
<li>ClusterRoleBindings</li>
<li>Role (for every namespaces)</li>
<li>RoleBindings (for every namespaces)</li>
<li>Group</li>
<li>Pod (for every namespaces)</li>
<li>ServiceAccount (for every namespaces)</li>
<li>PodSecurityPolicy</li>
<li>Network Policies depending on the CNI (Container Network Interface) used</li>
<li>Depending on the Kubernetes authentication mode : the related configuration if it is managed by a Kubernetes component. </li>
</ul>
<h1 id="r&#xE9;sum&#xE9;-des-commandes">R&#xE9;sum&#xE9; des commandes</h1>
<p>These command are here to help during the extraction. All commands are not compiled here. </p>
<p>Moreover, some parameters and absolute path may differ depending on the environment.</p>
<pre><code class="lang-bash"><span class="hljs-built_in">stat</span> -c %a /etc/kubernetes/manifests/kube-apiserver.yaml
<span class="hljs-built_in">stat</span> -c %U:%G /etc/kubernetes/manifests/kube-apiserver.yaml
<span class="hljs-built_in">stat</span> -c %a /etc/kubernetes/manifests/kube-controller-manager.yaml
<span class="hljs-built_in">stat</span> -c %U:%G /etc/kubernetes/manifests/kube-controller-manager.yaml
<span class="hljs-built_in">stat</span> -c %a /etc/kubernetes/manifests/kube-scheduler.yaml
<span class="hljs-built_in">stat</span> -c %U:%G /etc/kubernetes/manifests/kube-scheduler.yaml
<span class="hljs-built_in">stat</span> -c %a /etc/kubernetes/manifests/etcd.yaml
<span class="hljs-built_in">stat</span> -c %U:%G /etc/kubernetes/manifests/etcd.yaml
<span class="hljs-built_in">stat</span> -c %a &lt;path/to/cni/files&gt;
<span class="hljs-built_in">stat</span> -c %U:%G &lt;path/to/cni/files&gt;
<span class="hljs-built_in">stat</span> -c %a /var/lib/etcd
<span class="hljs-built_in">stat</span> -c %U:%G /var/lib/etcd
<span class="hljs-built_in">stat</span> -c %a /etc/kubernetes/admin.conf
<span class="hljs-built_in">stat</span> -c %U:%G /etc/kubernetes/admin.conf
<span class="hljs-built_in">stat</span> -c %a /etc/kubernetes/scheduler.conf
<span class="hljs-built_in">stat</span> -c %U:%G /etc/kubernetes/scheduler.conf
<span class="hljs-built_in">stat</span> -c %a /etc/kubernetes/controller-manager.conf
<span class="hljs-built_in">stat</span> -c %U:%G /etc/kubernetes/controller-manager.conf
ls -laR /etc/kubernetes/pki/
ls -laR /etc/kubernetes/pki/*.crt
ls -laR /etc/kubernetes/pki/*.key
ps -ef | grep kube-apiserver
ps -ef | grep kube-controller-manager
ps -ef | grep kube-scheduler
ps -ef | grep etcd
ps -ef | grep apiserver
<span class="hljs-built_in">stat</span> -c %a /etc/systemd/system/kubelet.service.d/10-kubeadm.conf
<span class="hljs-built_in">stat</span> -c %a &lt;path&gt;&lt;filename&gt;
<span class="hljs-built_in">stat</span> -c %U:%G &lt;path&gt;&lt;filename&gt;
<span class="hljs-built_in">stat</span> -c %a /etc/kubernetes/kubelet.conf
<span class="hljs-built_in">stat</span> -c %U %G /etc/kubernetes/kubelet.conf
<span class="hljs-built_in">stat</span> -c %a &lt;filename&gt;
<span class="hljs-built_in">stat</span> -c %U:%G &lt;filename&gt;
<span class="hljs-built_in">stat</span> -c %a /var/lib/kubelet/config.yaml
ps -ef | grep kubelet
ps -ef | grep kubelet 
kubectl get clusterrolebindings -o=customcolumns=NAME:.metadata.name,ROLE:.roleRef.name,SUBJECT:.subjects[*].name
kubectl get roles --all-namespaces -o yaml
kubectl get clusterroles -o yaml
kubectl get psp
kubectl get psp &lt;name&gt; -o=jsonpath=<span class="hljs-string">&apos;{.spec.privileged}&apos;</span>
kubectl get psp &lt;name&gt; -o=jsonpath=<span class="hljs-string">&apos;{.spec.hostPID}&apos;</span>
kubectl get psp &lt;name&gt; -o=jsonpath=<span class="hljs-string">&apos;{.spec.hostIPC}&apos;</span>
kubectl get psp &lt;name&gt; -o=jsonpath=<span class="hljs-string">&apos;{.spec.hostNetwork}&apos;</span>
kubectl get psp &lt;name&gt; -o=jsonpath=<span class="hljs-string">&apos;{.spec.allowPrivilegeEscalation}&apos;</span>
kubectl get psp &lt;name&gt; -o=jsonpath=<span class="hljs-string">&apos;{.spec.runAsUser.rule}&apos;</span>
kubectl get psp &lt;name&gt; -o=jsonpath=<span class="hljs-string">&apos;{.spec.requiredDropCapabilities}&apos;</span>
kubectl --all-namespaces get networkpolicy
kubectl get all -o jsonpath=<span class="hljs-string">&apos;{range .items[?(@..secretKeyRef)]} {.kind} {.metadata.name} {&quot;\n&quot;}{end}&apos;</span> -A
kubectl get namespaces
kubectl get all
</code></pre>
<h1 id="descriptif-des-tests">Descriptif des tests</h1>
<p>These tests are here to help during the extract analysis. Tests and verifications must be adapted depending on the environment and the context. </p>
<p>This tests are extracted from the <code>Center for Internet Security Kurbenetes Benchmark</code></p>
<p>Moreover, some parameters and absolute path may differ depending on the environment. </p>
<h2 id="test-0">Test 0</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %a /etc/kubernetes/manifests/kube-apiserver.yaml</li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-1">Test 1</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %U:%G /etc/kubernetes/manifests/kube-apiserver.yaml</li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-2">Test 2</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %a /etc/kubernetes/manifests/kube-controller-manager.yaml</li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-3">Test 3</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %U:%G /etc/kubernetes/manifests/kube-controller-manager.yaml</li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-4">Test 4</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %a /etc/kubernetes/manifests/kube-scheduler.yaml</li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-5">Test 5</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %U:%G /etc/kubernetes/manifests/kube-scheduler.yaml</li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-6">Test 6</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %a /etc/kubernetes/manifests/etcd.yaml</li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-7">Test 7</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %U:%G /etc/kubernetes/manifests/etcd.yaml</li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-8">Test 8</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %a <path to="" cni="" files=""></path></li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-9">Test 9</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %U:%G <path to="" cni="" files=""></path></li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-10">Test 10</h2>
<ul>
<li><code>test</code>: On the etcd server node, get the etcd data directory, passed as an argument --data-dir, from the below command: ps -ef | grep etcd. Run the below command (based on the etcd data directory found above).</li>
<li><code>command</code>: stat -c %a /var/lib/etcd</li>
<li><code>verif</code>: Verify that the permissions are 700 or more restrictive.</li>
</ul>
<h2 id="test-11">Test 11</h2>
<ul>
<li><code>test</code>: On the etcd server node, get the etcd data directory, passed as an argument --data-dir, from the below command: ps -ef | grep etcd. Run the below command (based on the etcd data directory found above).</li>
<li><code>command</code>: stat -c %U:%G /var/lib/etcd</li>
<li><code>verif</code>: Verify that the ownership is set to etcd:etcd.</li>
</ul>
<h2 id="test-12">Test 12</h2>
<ul>
<li><code>test</code>: Run the following command (based on the file location on your system) on the master node. </li>
<li><code>command</code>: stat -c %a /etc/kubernetes/admin.conf</li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-13">Test 13</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %U:%G /etc/kubernetes/admin.conf</li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-14">Test 14</h2>
<ul>
<li><code>test</code>: Run the following command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %a /etc/kubernetes/scheduler.conf</li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-15">Test 15</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %U:%G /etc/kubernetes/scheduler.conf</li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-16">Test 16</h2>
<ul>
<li><code>test</code>: Run the following command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %a /etc/kubernetes/controller-manager.conf</li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-17">Test 17</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: stat -c %U:%G /etc/kubernetes/controller-manager.conf</li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-18">Test 18</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: ls -laR /etc/kubernetes/pki/</li>
<li><code>verif</code>: Verify that the ownership of all files and directories in this hierarchy is set to root:root.</li>
</ul>
<h2 id="test-19">Test 19</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: ls -laR /etc/kubernetes/pki/*.crt</li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-20">Test 20</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the master node.</li>
<li><code>command</code>: ls -laR /etc/kubernetes/pki/*.key</li>
<li><code>verif</code>: Verify that the permissions are 600.</li>
</ul>
<h2 id="test-21">Test 21</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --anonymous-auth argument is set to false.</li>
</ul>
<h2 id="test-22">Test 22</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --token-auth-file argument does not exist.</li>
</ul>
<h2 id="test-23">Test 23</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --kubelet-https argument either does not exist or is set to true.</li>
</ul>
<h2 id="test-24">Test 24</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --kubelet-client-certificate and --kubelet-client-key arguments exist and they are set as appropriate.</li>
</ul>
<h2 id="test-25">Test 25</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --kubelet-certificate-authority argument exists and is set as appropriate.</li>
</ul>
<h2 id="test-26">Test 26</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --authorization-mode argument exists and is not set to AlwaysAllow.</li>
</ul>
<h2 id="test-27">Test 27</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --authorization-mode argument exists and is set to a value to include Node.</li>
</ul>
<h2 id="test-28">Test 28</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --authorization-mode argument exists and is set to a value to include RBAC.</li>
</ul>
<h2 id="test-29">Test 29</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --enable-admission-plugins argument is set to a value that includes EventRateLimit.</li>
</ul>
<h2 id="test-30">Test 30</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that if the --enable-admission-plugins argument is set, its value does not include AlwaysAdmit.</li>
</ul>
<h2 id="test-31">Test 31</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --enable-admission-plugins argument is set to a value that includes AlwaysPullImages.</li>
</ul>
<h2 id="test-32">Test 32</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --enable-admission-plugins argument is set to a value that includesSecurityContextDeny, if PodSecurityPolicy is not included.</li>
</ul>
<h2 id="test-33">Test 33</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --disable-admission-plugins argument is set to a value that does not includes ServiceAccount.</li>
</ul>
<h2 id="test-34">Test 34</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --disable-admission-plugins argument is set to a value that does not include NamespaceLifecycle.</li>
</ul>
<h2 id="test-35">Test 35</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --enable-admission-plugins argument is set to a value that includes PodSecurityPolicy.</li>
</ul>
<h2 id="test-36">Test 36</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --enable-admission-plugins argument is set to a value that includes NodeRestriction.</li>
</ul>
<h2 id="test-37">Test 37</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --insecure-bind-address argument does not exist.</li>
</ul>
<h2 id="test-38">Test 38</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --insecure-port argument is set to 0.</li>
</ul>
<h2 id="test-39">Test 39</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --secure-port argument is either not set or is set to an integer value between 1 and 65535.</li>
</ul>
<h2 id="test-40">Test 40</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --profiling argument is set to false.</li>
</ul>
<h2 id="test-41">Test 41</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --audit-log-path argument is set as appropriate.</li>
</ul>
<h2 id="test-42">Test 42</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --audit-log-maxage argument is set to 30 or as appropriate.</li>
</ul>
<h2 id="test-43">Test 43</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --audit-log-maxbackup argument is set to 10 or as appropriate.</li>
</ul>
<h2 id="test-44">Test 44</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --audit-log-maxsize argument is set to 100 or as appropriate.</li>
</ul>
<h2 id="test-45">Test 45</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --request-timeout argument is either not set or set to an appropriate value.</li>
</ul>
<h2 id="test-46">Test 46</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that if the --service-account-lookup argument exists it is set to true.</li>
</ul>
<h2 id="test-47">Test 47</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --service-account-key-file argument exists and is set as appropriate.</li>
</ul>
<h2 id="test-48">Test 48</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --etcd-certfile and --etcd-keyfile arguments exist and they are set as appropriate.</li>
</ul>
<h2 id="test-49">Test 49</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --tls-cert-file and --tls-private-key-file arguments exist and they are set as appropriate.</li>
</ul>
<h2 id="test-50">Test 50</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --client-ca-file argument exists and it is set as appropriate.</li>
</ul>
<h2 id="test-51">Test 51</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --etcd-cafile argument exists and it is set as appropriate.</li>
</ul>
<h2 id="test-52">Test 52</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --encryption-provider-config argument is set to a EncryptionConfig file. Additionally, ensure that the EncryptionConfig file has all the desired resources covered especially any secrets.</li>
</ul>
<h2 id="test-53">Test 53</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Get the EncryptionConfig file set for --encryption-provider-config argument. Verify that aescbc, kms or secretbox is set as the encryption provider for all the desired resources.</li>
</ul>
<h2 id="test-54">Test 54</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --tls-cipher-suites argument is set as outlined in the remediation procedure below.</li>
</ul>
<h2 id="test-55">Test 55</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-controller-manager</li>
<li><code>verif</code>: Verify that the --terminated-pod-gc-threshold argument is set as appropriate.</li>
</ul>
<h2 id="test-56">Test 56</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-controller-manager</li>
<li><code>verif</code>: Verify that the --profiling argument is set to false.</li>
</ul>
<h2 id="test-57">Test 57</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-controller-manager</li>
<li><code>verif</code>: Verify that the --use-service-account-credentials argument is set to true.</li>
</ul>
<h2 id="test-58">Test 58</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-controller-manager</li>
<li><code>verif</code>: Verify that the --service-account-private-key-file argument is set as appropriate.</li>
</ul>
<h2 id="test-59">Test 59</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-controller-manager</li>
<li><code>verif</code>: Verify that the --root-ca-file argument exists and is set to a certificate bundle file containing the root certificate for the API server&apos;s serving certificate.</li>
</ul>
<h2 id="test-60">Test 60</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-controller-manager</li>
<li><code>verif</code>: Verify that RotateKubeletServerCertificate argument exists and is set to true.</li>
</ul>
<h2 id="test-61">Test 61</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-controller-manager</li>
<li><code>verif</code>: Verify that the --bind-address argument is set to 127.0.0.1</li>
</ul>
<h2 id="test-62">Test 62</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-scheduler</li>
<li><code>verif</code>: Verify that the --profiling argument is set to false.</li>
</ul>
<h2 id="test-63">Test 63</h2>
<ul>
<li><code>test</code>: Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep kube-scheduler</li>
<li><code>verif</code>: Verify that the --bind-address argument is set to 127.0.0.1</li>
</ul>
<h2 id="test-64">Test 64</h2>
<ul>
<li><code>test</code>: Run the following command on the etcd server node</li>
<li><code>command</code>: ps -ef | grep etcd</li>
<li><code>verif</code>: Verify that the --cert-file and the --key-file arguments are set as appropriate.</li>
</ul>
<h2 id="test-65">Test 65</h2>
<ul>
<li><code>test</code>: Run the following command on the etcd server node:</li>
<li><code>command</code>: ps -ef | grep etcd</li>
<li><code>verif</code>: Verify that the --client-cert-auth argument is set to true.</li>
</ul>
<h2 id="test-66">Test 66</h2>
<ul>
<li><code>test</code>: Run the following command on the etcd server node:</li>
<li><code>command</code>: ps -ef | grep etcd</li>
<li><code>verif</code>: Verify that if the --auto-tls argument exists, it is not set to true.</li>
</ul>
<h2 id="test-67">Test 67</h2>
<ul>
<li><code>test</code>: Run the following command on the etcd server node:</li>
<li><code>command</code>: ps -ef | grep etcd</li>
<li><code>verif</code>: Verify that the --peer-cert-file and --peer-key-file arguments are set as appropriate. Note: This recommendation is applicable only for etcd clusters. If you are using only one etcd server in your environment then this recommendation is not applicable.</li>
</ul>
<h2 id="test-68">Test 68</h2>
<ul>
<li><code>test</code>: Run the following command on the etcd server node:</li>
<li><code>command</code>: ps -ef | grep etcd</li>
<li><code>verif</code>: Verify that the --peer-client-cert-auth argument is set to true. Note: This recommendation is applicable only for etcd clusters. If you are using only one etcd server in your environment then this recommendation is not applicable.</li>
</ul>
<h2 id="test-69">Test 69</h2>
<ul>
<li><code>test</code>: Run the following command on the etcd server node:</li>
<li><code>command</code>: ps -ef | grep etcd</li>
<li><code>verif</code>: Verify that if the --peer-auto-tls argument exists, it is not set to true. Note: This recommendation is applicable only for etcd clusters. If you are using only one etcd server in your environment then this recommendation is not applicable.</li>
</ul>
<h2 id="test-70">Test 70</h2>
<ul>
<li><code>test</code>: Review the CA used by the etcd environment and ensure that it does not match the CA certificate file used for the management of the overall Kubernetes cluster. Run the following command on the master node: ps -ef | grep etcd. Note the file referenced by the --trusted-ca-file argument. Run the following command on the master node:</li>
<li><code>command</code>: ps -ef | grep apiserver</li>
<li><code>verif</code>: Verify that the file referenced by the --client-ca-file for apiserver is different from the --trusted-ca-file used by etcd.</li>
</ul>
<h2 id="test-71">Test 71</h2>
<ul>
<li><code>test</code>: Review user access to the cluster and ensure that users are not making use of Kubernetes client certificate authentication.</li>
<li><code>command</code>: </li>
<li><code>verif</code>: </li>
</ul>
<h2 id="test-72">Test 72</h2>
<ul>
<li><code>test</code>: Run the following command on one of the cluster master nodes:</li>
<li><code>command</code>: ps -ef | grep kube-apiserver</li>
<li><code>verif</code>: Verify that the --audit-policy-file is set. Review the contents of the file specified and ensure that it contains a valid audit policy.</li>
</ul>
<h2 id="test-73">Test 73</h2>
<ul>
<li><code>test</code>: Review the audit policy provided for the cluster and ensure that it covers at least the following areas : / Access to Secrets managed by the cluster. / Modification of pod and deployment objects. / Use of pods or exec, pods or portforward, pods or proxy and services or proxy. For most requests, minimally logging at the Metadata level is recommended (the most basic level of logging).</li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: Care should be taken to only log Metadata for requests to Secrets, ConfigMaps, and TokenReviews, in order to avoid the risk of logging sensitive data.</li>
</ul>
<h2 id="test-74">Test 74</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the each worker node.</li>
<li><code>command</code>: stat -c %a /etc/systemd/system/kubelet.service.d/10-kubeadm.conf</li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-75">Test 75</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the each worker node.</li>
<li><code>command</code>: stat -c %a /etc/systemd/system/kubelet.service.d/10-kubeadm.conf</li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-76">Test 76</h2>
<ul>
<li><code>test</code>: Find the kubeconfig file being used by kube-proxy by running the following command: ps -ef | grep kube-proxy. If kube-proxy is running, get the kubeconfig file location from the --kubeconfig parameter. Run the below command (based on the file location on your system) on the each worker node.</li>
<li><code>command</code>: stat -c %a <path></path><filename></filename></li>
<li><code>verif</code>: Verify that a file is specified and it exists with permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-77">Test 77</h2>
<ul>
<li><code>test</code>: Find the kubeconfig file being used by kube-proxy by running the following command: ps -ef | grep kube-proxy. If kube-proxy is running, get the kubeconfig file location from the --kubeconfig parameter. Run the below command (based on the file location on your system) on the each worker node.</li>
<li><code>command</code>: stat -c %U:%G <path></path><filename></filename></li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-78">Test 78</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the each worker node. For example,</li>
<li><code>command</code>: stat -c %a /etc/kubernetes/kubelet.conf</li>
<li><code>verif</code>: Verify that the ownership is set to root:root.Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-79">Test 79</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the each worker node.</li>
<li><code>command</code>: stat -c %U %G /etc/kubernetes/kubelet.conf</li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-80">Test 80</h2>
<ul>
<li><code>test</code>: Run the following command: ps -ef | grep kubelet. Find the file specified by the --client-ca-file argument. Run the following command:</li>
<li><code>command</code>: stat -c %a <filename></filename></li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-81">Test 81</h2>
<ul>
<li><code>test</code>: Run the following command: ps -ef | grep kubelet. Find the file specified by the --client-ca-file argument. Run the following command:</li>
<li><code>command</code>: stat -c %U:%G <filename></filename></li>
<li><code>verif</code>: Verify that the ownership is set to root:root.</li>
</ul>
<h2 id="test-82">Test 82</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the each worker node.</li>
<li><code>command</code>: stat -c %a /var/lib/kubelet/config.yaml</li>
<li><code>verif</code>: Verify that the permissions are 644 or more restrictive.</li>
</ul>
<h2 id="test-83">Test 83</h2>
<ul>
<li><code>test</code>: Run the below command (based on the file location on your system) on the each worker node.</li>
<li><code>command</code>: stat -c %a /var/lib/kubelet/config.yaml</li>
<li><code>verif</code>: Verify that the ownership is set to <code>root:root</code>.</li>
</ul>
<h2 id="test-84">Test 84</h2>
<ul>
<li><code>test</code>: If using a Kubelet configuration file, check that there is an entry for authentication: &apos;anonymous: enabled&apos; set to false. Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: Verify that the --anonymous-auth argument is set to false. This executable argument may be omitted, provided there is a corresponding entry set to false in the Kubelet config file.</li>
</ul>
<h2 id="test-85">Test 85</h2>
<ul>
<li><code>test</code>: Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: If the --authorization-mode argument is present check that it is not set to AlwaysAllow. If it is not present check that there is a Kubelet config file specified by --config, and that file sets authorization: mode to something other than AlwaysAllow. It is also possible to review the running configuration of a Kubelet via the /configz endpoint on the Kubelet API port (typically 10250/TCP). Accessing these with appropriate credentials will provide details of the Kubelet&apos;s configuration.</li>
</ul>
<h2 id="test-86">Test 86</h2>
<ul>
<li><code>test</code>: Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: Verify that the --client-ca-file argument exists and is set to the location of the client certificate authority file. If the --client-ca-file argument is not present, check that there is a Kubelet config file specified by --config, and that the file sets authentication: x509: clientCAFile to the location of the client certificate authority file.</li>
</ul>
<h2 id="test-87">Test 87</h2>
<ul>
<li><code>test</code>: Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: Verify that the --read-only-port argument exists and is set to 0. If the --read-only-port argument is not present, check that there is a Kubelet config file specified by --config. Check that if there is a readOnlyPort entry in the file, it is set to 0.</li>
</ul>
<h2 id="test-88">Test 88</h2>
<ul>
<li><code>test</code>: Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: Verify that the --streaming-connection-idle-timeout argument is not set to 0. If the argument is not present, and there is a Kubelet config file specified by --config, check that it does not set streamingConnectionIdleTimeout to 0.</li>
</ul>
<h2 id="test-89">Test 89</h2>
<ul>
<li><code>test</code>: Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: Verify that the --protect-kernel-defaults argument is set to true. If the --protect-kernel-defaults argument is not present, check that there is a Kubelet config file specified by --config, and that the file sets protectKernelDefaults to true.</li>
</ul>
<h2 id="test-90">Test 90</h2>
<ul>
<li><code>test</code>: Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet </li>
<li><code>verif</code>: Verify that if the --make-iptables-util-chains argument exists then it is set to true. If the --make-iptables-util-chains argument does not exist, and there is a Kubelet config file specified by --config, verify that the file does not set makeIPTablesUtilChains to false.</li>
</ul>
<h2 id="test-91">Test 91</h2>
<ul>
<li><code>test</code>: Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: Verify that --hostname-override argument does not exist. Note This setting is not configurable via the Kubelet config file.</li>
</ul>
<h2 id="test-92">Test 92</h2>
<ul>
<li><code>test</code>: Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: Review the value set for the --event-qps argument and determine whether this has been set to an appropriate level for the cluster. The value of 0 can be used to ensure that all events are captured. If the --event-qps argument does not exist, check that there is a Kubelet config file specified by --config and review the value in this location.</li>
</ul>
<h2 id="test-93">Test 93</h2>
<ul>
<li><code>test</code>: Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet </li>
<li><code>verif</code>: Verify that the --tls-cert-file and --tls-private-key-file arguments exist and they are set as appropriate. If these arguments are not present, check that there is a Kubelet config specified by --config and that it contains appropriate settings for tlsCertFile and tlsPrivateKeyFile.</li>
</ul>
<h2 id="test-94">Test 94</h2>
<ul>
<li><code>test</code>: Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: Verify that the --rotate-certificates argument is not present, or is set to true. If the --rotate-certificates argument is not present, verify that if there is a Kubelet config file specified by --config, that file does not contain rotateCertificates: false.</li>
</ul>
<h2 id="test-95">Test 95</h2>
<ul>
<li><code>test</code>: Ignore this check if serverTLSBootstrap is true in the kubelet config file or if the --rotateserver-certificates parameter is set on kubelet. Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: Verify that RotateKubeletServerCertificate argument exists and is set to true.</li>
</ul>
<h2 id="test-96">Test 96</h2>
<ul>
<li><code>test</code>: The set of cryptographic ciphers currently considered secure is the following:,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256. Run the following command on each node:</li>
<li><code>command</code>: ps -ef | grep kubelet</li>
<li><code>verif</code>: If the --tls-cipher-suites argument is present, ensure it only contains values included in this set. If it is not present check that there is a Kubelet config file specified by --config, and that file sets TLSCipherSuites: to only include values from this set.</li>
</ul>
<h2 id="test-97">Test 97</h2>
<ul>
<li><code>test</code>: Obtain a list of the principals who have access to the cluster-admin role by reviewing the clusterrolebinding output for each role binding that has access to the cluster-admin role.</li>
<li><code>command</code>: kubectl get clusterrolebindings -o=customcolumns=NAME:.metadata.name,ROLE:.roleRef.name,SUBJECT:.subjects[*].name </li>
<li><code>verif</code>: Review each principal listed and ensure that cluster-admin privilege is required for it.</li>
</ul>
<h2 id="test-98">Test 98</h2>
<ul>
<li><code>test</code>: Review the users who have get, list or watch access to secrets objects in the Kubernetes API.</li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: </li>
</ul>
<h2 id="test-99">Test 99</h2>
<ul>
<li><code>test</code>: Retrieve the roles defined across each namespaces in the cluster and review for wildcards</li>
<li><code>command</code>: kubectl get roles --all-namespaces -o yaml</li>
<li><code>verif</code>: Verify wildcard are not used</li>
</ul>
<h2 id="test-100">Test 100</h2>
<ul>
<li><code>test</code>: Retrieve the cluster roles defined in the cluster and review for wildcards</li>
<li><code>command</code>: kubectl get clusterroles -o yaml</li>
<li><code>verif</code>: Verify wildcard are not used</li>
</ul>
<h2 id="test-101">Test 101</h2>
<ul>
<li><code>test</code>: Review the users who have create access to pod objects in the Kubernetes API.</li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: </li>
</ul>
<h2 id="test-102">Test 102</h2>
<ul>
<li><code>test</code>: For each namespace in the cluster, review the rights assigned to the default service account</li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: Ensure that it has no roles or cluster roles bound to it apart from the defaults. Additionally ensure that the automountServiceAccountToken: false setting is in place for each default service account.</li>
</ul>
<h2 id="test-103">Test 103</h2>
<ul>
<li><code>test</code>: Review pod and service account objects in the cluster </li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: Ensure that the option below is set, unless the resource explicitly requires this access.automountServiceAccountToken: false</li>
</ul>
<h2 id="test-104">Test 104</h2>
<ul>
<li><code>test</code>: Review a list of all credentials which have access to the cluster</li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: Ensure that the group system:masters is not used.</li>
</ul>
<h2 id="test-105">Test 105</h2>
<ul>
<li><code>test</code>: Review the users who have access to cluster roles or roles which provide the impersonate, bind or escalate privileges.</li>
<li><code>command</code>: </li>
<li><code>verif</code>: </li>
</ul>
<h2 id="test-106">Test 106</h2>
<ul>
<li><code>test</code>: Get the set of PSPs with the following command: kubectl get psp. For each PSP, check whether privileged is enabled:</li>
<li><code>command</code>: kubectl get psp <name> -o=jsonpath=&apos;{.spec.privileged}&apos;</name></li>
<li><code>verif</code>: Verify that there is at least one PSP which does not return true.</li>
</ul>
<h2 id="test-107">Test 107</h2>
<ul>
<li><code>test</code>: Get the set of PSPs with the following command: kubectl get psp. For each PSP, check whether privileged is enabled:</li>
<li><code>command</code>: kubectl get psp <name> -o=jsonpath=&apos;{.spec.hostPID}&apos;</name></li>
<li><code>verif</code>: Verify that there is at least one PSP which does not return true.</li>
</ul>
<h2 id="test-108">Test 108</h2>
<ul>
<li><code>test</code>: Get the set of PSPs with the following command: kubectl get psp. For each PSP, check whether privileged is enabled:</li>
<li><code>command</code>: kubectl get psp <name> -o=jsonpath=&apos;{.spec.hostIPC}&apos;</name></li>
<li><code>verif</code>: Verify that there is at least one PSP which does not return true.</li>
</ul>
<h2 id="test-109">Test 109</h2>
<ul>
<li><code>test</code>: Get the set of PSPs with the following command: kubectl get psp. For each PSP, check whether privileged is enabled:</li>
<li><code>command</code>: kubectl get psp <name> -o=jsonpath=&apos;{.spec.hostNetwork}&apos;</name></li>
<li><code>verif</code>: Verify that there is at least one PSP which does not return true.</li>
</ul>
<h2 id="test-110">Test 110</h2>
<ul>
<li><code>test</code>: Get the set of PSPs with the following command: kubectl get psp. For each PSP, check whether privileged is enabled:</li>
<li><code>command</code>: kubectl get psp <name> -o=jsonpath=&apos;{.spec.allowPrivilegeEscalation}&apos;</name></li>
<li><code>verif</code>: Verify that there is at least one PSP which does not return true.</li>
</ul>
<h2 id="test-111">Test 111</h2>
<ul>
<li><code>test</code>: Get the set of PSPs with the following command: kubectl get psp. For each PSP, check whether running containers as root is enabled:</li>
<li><code>command</code>: kubectl get psp <name> -o=jsonpath=&apos;{.spec.runAsUser.rule}&apos;</name></li>
<li><code>verif</code>: Verify that there is at least one PSP which returns MustRunAsNonRoot or MustRunAs with the range of UIDs not including 0.</li>
</ul>
<h2 id="test-112">Test 112</h2>
<ul>
<li><code>test</code>: Get the set of PSPs with the following command: kubectl get psp. For each PSP, check whether NET_RAW is disabled:</li>
<li><code>command</code>: kubectl get psp <name> -o=jsonpath=&apos;{.spec.requiredDropCapabilities}&apos;</name></li>
<li><code>verif</code>: Verify that there is at least one PSP which returns NET_RAW or ALL.</li>
</ul>
<h2 id="test-113">Test 113</h2>
<ul>
<li><code>test</code>: Get the set of PSPs with the following command:</li>
<li><code>command</code>: kubectl get psp</li>
<li><code>verif</code>: Verify that there are no PSPs present which have allowedCapabilities set to anything other than an empty array.</li>
</ul>
<h2 id="test-114">Test 114</h2>
<ul>
<li><code>test</code>: Get the set of PSPs with the following command: kubectl get psp. For each PSP, check whether capabilities have been forbidden:</li>
<li><code>command</code>: kubectl get psp <name> -o=jsonpath=&apos;{.spec.requiredDropCapabilities}&apos;</name></li>
<li><code>verif</code>: </li>
</ul>
<h2 id="test-115">Test 115</h2>
<ul>
<li><code>test</code>: Review the documentation of CNI plugin in use by the cluster</li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: Confirm that it supports Ingress and Egress network policies.</li>
</ul>
<h2 id="test-116">Test 116</h2>
<ul>
<li><code>test</code>: Run the below command and review the NetworkPolicy objects created in the cluster.</li>
<li><code>command</code>: kubectl --all-namespaces get networkpolicy</li>
<li><code>verif</code>: Ensure that each namespace defined in the cluster has at least one Network Policy.</li>
</ul>
<h2 id="test-117">Test 117</h2>
<ul>
<li><code>test</code>: Run the following command to find references to objects which use environment variables defined from secret</li>
<li><code>command</code>: kubectl get all -o jsonpath=&apos;{range .items[?(@..secretKeyRef)]} {.kind} {.metadata.name} {&quot;\n&quot;}{end}&apos; -A</li>
<li><code>verif</code>: </li>
</ul>
<h2 id="test-118">Test 118</h2>
<ul>
<li><code>test</code>: Review your secrets management implementation.</li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: </li>
</ul>
<h2 id="test-119">Test 119</h2>
<ul>
<li><code>test</code>: Review the pod definitions in your cluster </li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: Verify that image provenance is configured as appropriate.</li>
</ul>
<h2 id="test-120">Test 120</h2>
<ul>
<li><code>test</code>: Run the below command and review the namespaces created in the cluster.</li>
<li><code>command</code>: kubectl get namespaces</li>
<li><code>verif</code>: Ensure that these namespaces are the ones you need and are adequately administered as per your requirements.</li>
</ul>
<h2 id="test-121">Test 121</h2>
<ul>
<li><code>test</code>: Review the pod definitions in your cluster. </li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: Verify it create a line as follow: securityContext: seccompProfile: type: RuntimeDefault</li>
</ul>
<h2 id="test-122">Test 122</h2>
<ul>
<li><code>test</code>: Review the pod definitions in your cluster</li>
<li><code>command</code>: # NO COMMAND</li>
<li><code>verif</code>: verify that you have security contexts defined as appropriate.</li>
</ul>
<h2 id="test-123">Test 123</h2>
<ul>
<li><code>test</code>: Run this command to list objects in default namespace</li>
<li><code>command</code>: kubectl get all</li>
<li><code>verif</code>: The only entries there should be system managed resources such as the kubernetes service</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Kubernetes.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Kubernetes">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"KubernetesCIS","level":"4.1.2.3","depth":3,"next":{"title":"Services","level":"4.1.3","depth":2,"ref":"","articles":[{"title":"AD","level":"4.1.3.1","depth":3,"path":"Pentest/Services/AD.md","ref":"Pentest/Services/AD.md","articles":[]},{"title":"DNS","level":"4.1.3.2","depth":3,"path":"Pentest/Services/DNS.md","ref":"Pentest/Services/DNS.md","articles":[]},{"title":"IPMI","level":"4.1.3.3","depth":3,"path":"Pentest/Services/IPMI.md","ref":"Pentest/Services/IPMI.md","articles":[]},{"title":"Kerberos","level":"4.1.3.4","depth":3,"path":"Pentest/Services/Kerberos.md","ref":"Pentest/Services/Kerberos.md","articles":[]},{"title":"LDAP","level":"4.1.3.5","depth":3,"path":"Pentest/Services/LDAP.md","ref":"Pentest/Services/LDAP.md","articles":[]},{"title":"Memcached","level":"4.1.3.6","depth":3,"path":"Pentest/Services/Memcached.md","ref":"Pentest/Services/Memcached.md","articles":[]},{"title":"NFS","level":"4.1.3.7","depth":3,"path":"Pentest/Services/NFS.md","ref":"Pentest/Services/NFS.md","articles":[]},{"title":"Oracle Database","level":"4.1.3.8","depth":3,"path":"Pentest/Services/Oracle database.md","ref":"Pentest/Services/Oracle database.md","articles":[]},{"title":"MSSQL","level":"4.1.3.9","depth":3,"path":"Pentest/Services/MSSQL.md","ref":"Pentest/Services/MSSQL.md","articles":[]},{"title":"RPC","level":"4.1.3.10","depth":3,"path":"Pentest/Services/RPC.md","ref":"Pentest/Services/RPC.md","articles":[]},{"title":"SMB","level":"4.1.3.11","depth":3,"path":"Pentest/Services/SMB.md","ref":"Pentest/Services/SMB.md","articles":[]},{"title":"SNMP","level":"4.1.3.12","depth":3,"path":"Pentest/Services/SNMP.md","ref":"Pentest/Services/SNMP.md","articles":[]},{"title":"Tomcat","level":"4.1.3.13","depth":3,"path":"Pentest/Services/Tomcat.md","ref":"Pentest/Services/Tomcat.md","articles":[]},{"title":"WebDAV","level":"4.1.3.14","depth":3,"path":"Pentest/Services/WebDAV.md","ref":"Pentest/Services/WebDAV.md","articles":[]}]},"previous":{"title":"Kubernetes","level":"4.1.2.2","depth":3,"path":"Pentest/Configuration review/Kubernetes.md","ref":"Pentest/Configuration review/Kubernetes.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-sharing","collapsible-chapters@git+https://gitlab.dqr/gitbook-plugin/collapsible-chapters.git#main","copy-code-button@git+https://gitlab.dqr/gitbook-plugin/copy-code-button.git#main","hide-published-with","search-plus","simple-page-toc"],"pluginsConfig":{"github":{"url":"https://github.com/YoannDqr"},"simple-page-toc":{"maxDepth":3,"skipFirstH1":true},"search":{},"collapsible-chapters":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"hide-published-with":{},"fontsettings":{"theme":"white","family":"sans","size":2},"twitter":{"url":"https://twitter.com/HackerOtter"},"highlight":{},"copy-code-button":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"search-plus":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Pentest/Configuration review/KubernetesCIS.md","mtime":"2022-07-09T22:01:01.473Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-09-23T14:26:48.100Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-hide-published-with/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

